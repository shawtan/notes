<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>CS458notes</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">body {
font-family: Helvetica, arial, sans-serif;
font-size: 14px;
line-height: 1.6;
padding-top: 10px;
padding-bottom: 10px;
background-color: white;
padding: 30px; }
body > *:first-child {
margin-top: 0 !important; }
body > *:last-child {
margin-bottom: 0 !important; }
a {
color: #4183C4; }
a.absent {
color: #cc0000; }
a.anchor {
display: block;
padding-left: 30px;
margin-left: -30px;
cursor: pointer;
position: absolute;
top: 0;
left: 0;
bottom: 0; }
h1, h2, h3, h4, h5, h6 {
margin: 20px 0 10px;
padding: 0;
font-weight: bold;
-webkit-font-smoothing: antialiased;
cursor: text;
position: relative; }
h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
text-decoration: none; }
h1 tt, h1 code {
font-size: inherit; }
h2 tt, h2 code {
font-size: inherit; }
h3 tt, h3 code {
font-size: inherit; }
h4 tt, h4 code {
font-size: inherit; }
h5 tt, h5 code {
font-size: inherit; }
h6 tt, h6 code {
font-size: inherit; }
h1 {
font-size: 28px;
color: black; }
h2 {
font-size: 24px;
border-bottom: 1px solid #cccccc;
color: black; }
h3 {
font-size: 18px; }
h4 {
font-size: 16px; }
h5 {
font-size: 14px; }
h6 {
color: #777777;
font-size: 14px; }
p, blockquote, ul, ol, dl, li, table, pre {
margin: 0 0 10px; }
hr {
margin: 0 0 19px;
border: 0;
border-bottom: 1px solid #ccc;
}
body > h2:first-child {
margin-top: 0;
padding-top: 0; }
body > h1:first-child {
margin-top: 0;
padding-top: 0; }
body > h1:first-child + h2 {
margin-top: 0;
padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
margin-top: 0;
padding-top: 0; }
a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
margin-top: 0;
padding-top: 0; }
h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
margin-top: 0; }
li p.first {
display: inline-block; }
li {
margin: 0; }
ul, ol {
padding-left: 30px; }
ul :first-child, ol :first-child {
margin-top: 0; }
dl {
padding: 0; }
dl dt {
font-size: 14px;
font-weight: bold;
font-style: italic;
padding: 0;
margin: 15px 0 5px; }
dl dt:first-child {
padding: 0; }
dl dt > :first-child {
margin-top: 0; }
dl dt > :last-child {
margin-bottom: 0; }
dl dd {
margin: 0 0 15px;
padding: 0 15px; }
dl dd > :first-child {
margin-top: 0; }
dl dd > :last-child {
margin-bottom: 0; }
blockquote {
border-left: 4px solid #dddddd;
padding: 0 15px;
color: #777777; }
blockquote > :first-child {
margin-top: 0; }
blockquote > :last-child {
margin-bottom: 0; }
table {
padding: 0;border-collapse: collapse; }
table tr {
border-top: 1px solid #cccccc;
background-color: white;
margin: 0;
padding: 0; }
table tr:nth-child(2n) {
background-color: #f8f8f8; }
table tr th {
font-weight: bold;
border: 1px solid #cccccc;
margin: 0;
padding: 6px 13px; }
table tr td {
border: 1px solid #cccccc;
margin: 0;
padding: 6px 13px; }
table tr th :first-child, table tr td :first-child {
margin-top: 0; }
table tr th :last-child, table tr td :last-child {
margin-bottom: 0; }
img {
max-width: 100%; }
span.frame {
display: block;
overflow: hidden; }
span.frame > span {
border: 1px solid #dddddd;
display: block;
float: left;
overflow: hidden;
margin: 13px 0 0;
padding: 7px;
width: auto; }
span.frame span img {
display: block;
float: left; }
span.frame span span {
clear: both;
color: #333333;
display: block;
padding: 5px 0 0; }
span.align-center {
display: block;
overflow: hidden;
clear: both; }
span.align-center > span {
display: block;
overflow: hidden;
margin: 13px auto 0;
text-align: center; }
span.align-center span img {
margin: 0 auto;
text-align: center; }
span.align-right {
display: block;
overflow: hidden;
clear: both; }
span.align-right > span {
display: block;
overflow: hidden;
margin: 13px 0 0;
text-align: right; }
span.align-right span img {
margin: 0;
text-align: right; }
span.float-left {
display: block;
margin-right: 13px;
overflow: hidden;
float: left; }
span.float-left span {
margin: 13px 0 0; }
span.float-right {
display: block;
margin-left: 13px;
overflow: hidden;
float: right; }
span.float-right > span {
display: block;
overflow: hidden;
margin: 13px auto 0;
text-align: right; }
code, tt {
margin: 0 2px;
padding: 0 5px;
white-space: nowrap;
border: 1px solid #eaeaea;
background-color: #f8f8f8;
border-radius: 3px; }
pre code {
margin: 0;
padding: 0;
white-space: pre;
border: none;
background: transparent; }
.highlight pre {
background-color: #f8f8f8;
border: 1px solid #cccccc;
font-size: 13px;
line-height: 19px;
overflow: auto;
padding: 6px 10px;
border-radius: 3px; }
pre {
background-color: #f8f8f8;
border: 1px solid #cccccc;
font-size: 13px;
line-height: 19px;
overflow: auto;
padding: 6px 10px;
border-radius: 3px; }
pre code, pre tt {
background-color: transparent;
border: none; }
sup {
font-size: 0.83em;
vertical-align: super;
line-height: 0;
}
* {
-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
body {
width: 854px;
margin:0 auto;
}
}
@media print {
table, pre {
page-break-inside: avoid;
}
pre {
word-wrap: break-word;
}
}
</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="cs-458">CS 458</h1>
<h1 id="introduction-to-security-and-privacy">Introduction to Security and Privacy</h1>
<h2 id="security">Security</h2>
<ul>
<li>Confidentiality
<ul>
<li>Access to systems or data is limited to authorized parties</li>
</ul></li>
<li>Integrity
<ul>
<li>Data is correct</li>
</ul></li>
<li>Availabilty
<ul>
<li>System or data is there when you want it</li>
</ul></li>
</ul>
<h2 id="privacy">Privacy</h2>
<ul>
<li><em>Informational self-determination</em>: You get to control information about yourself</li>
<li>e.g PIPEDA is Canadian legislation for personal privacy</li>
</ul>
<blockquote>
<p>Privacy vs Confidentiality For example, a company collecting your private information with your consent but then using it in ways that you don’t understand without disclosing their methods to you is a breach of privacy because you don’t have to ability to determine <em>how</em> your personal information is used. It is not a breach of confidentiality because you have consent and full knowledge that they have access to your information. On the other hand, a breach where company secrets (say a soft drink recipe) are leaked to the public is a violation of confidentiality because information is seen by unauthorized parties. It is not a breach of privacy however because (however much the legal system wants them to be) companies are not people and so there was not personally private information that was leaked.</p>
</blockquote>
<h2 id="other-definitions">Other Definitions</h2>
<ul>
<li>Assets: Things we want to protect
<ul>
<li>e.g Hardware, Software, Data</li>
</ul></li>
<li>Vulnerabilities: Weaknesses in a system that can be exploited</li>
<li>Threats: Loss or harm that can occur to a system
<ol type="1">
<li>Interception: unauthorized access</li>
<li>Interruption: making service unavailable</li>
<li>Modification: tampering</li>
<li>Fabrication: counterfeit records</li>
</ol></li>
<li>Threat model: What threats do we need to defend against</li>
<li>Attack: Action that exploits a vulnerability to execute a threat</li>
<li>Control/Defence: Removing or reducing a vulnerability
<ol type="1">
<li>Prevention: Prevent the attack</li>
<li>Deterence: Make attack harder or more expensive</li>
<li>Deflection: Make self self attractive to attack</li>
<li>Detection: Notice attacks occuring / occured</li>
<li>Recovery: Mitigate attack effects</li>
</ol></li>
</ul>
<h2 id="principles">Principles</h2>
<ul>
<li>Principle of Easiest Penetration
<ul>
<li>System only as strong as weakest link</li>
</ul></li>
<li>Principle of Adequate Protection
<ul>
<li>Security should be relative to value of the system</li>
</ul></li>
</ul>
<h2 id="defense">Defense</h2>
<ul>
<li>Cryptography
<ul>
<li>Makes data unreadable to attacker</li>
</ul></li>
<li>Software Controls
<ul>
<li>e.g passwords</li>
</ul></li>
<li>Hardware Controls
<ul>
<li>e.g fingerprint reader</li>
</ul></li>
<li>Physical Controls
<ul>
<li>e.g locks</li>
</ul></li>
<li>Policies and Procedures
<ul>
<li>e.g user privileges, password rules</li>
</ul></li>
</ul>
<h1 id="program-security">Program Security</h1>
<h2 id="format-string-vulnerabilities">Format String Vulnerabilities</h2>
<ul>
<li>Seg fault means you are in the right place</li>
<li>Print ’%s’x1000 until you get a seg fault</li>
<li>Execute with ‘%n’</li>
</ul>
<h2 id="malware">Malware</h2>
<h3 id="viruses">Viruses</h3>
<ul>
<li>Requires user interaction to spread</li>
</ul>
<h4 id="payload">Payload</h4>
<ul>
<li>Any part of the virus code that is not the self replicating part</li>
<li>Extra code</li>
</ul>
<h4 id="spotting-viruses">Spotting Viruses</h4>
<ul>
<li>Look at new files, occasionally do a full computer scan</li>
<li>Signature-based protection
<ul>
<li>Maintain list of all known viruses and its characteristic features</li>
<li>Payload code, infection code are usually unique</li>
<li>Can also identify system locations and propagation means</li>
<li>Cons: Fooled by polymorphic viruses</li>
<li>Cons: Can’t identify new viruses</li>
<li>No false positives</li>
<li>High false negatives</li>
</ul></li>
<li>Behaviour-based protection
<ul>
<li>Look for suspicious patterns of behaviour</li>
<li>Run new code in a sandbox first
<ul>
<li>Some viruses can detect if they are in a sandbox</li>
</ul></li>
<li>Medium false positives</li>
<li>Medium false negatives</li>
</ul></li>
<li>False negatives are worse than false positives</li>
<li>Base Rate Fallacy (Wacky probabilities when the base rate is low)</li>
</ul>
<h4 id="polymorphic-viruses">Polymorphic viruses</h4>
<ul>
<li>Viruses can alter themselves to escape signature based detection</li>
<li>e.g Decryption routine followed by encryted code</li>
<li>Include jumps to mix up instruction order</li>
<li>Add NOPs</li>
<li>Set <code>x=0</code> as <code>x=x-x</code> or <code>x=x*0</code></li>
</ul>
<h3 id="worms">Worms</h3>
<ul>
<li>Spreads with no or little user involvement
<ol type="1">
<li>Infects your computer</li>
<li>Searches for other computers (over network) to infect</li>
<li>May have a payload that activates by a trigger</li>
</ol></li>
<li>e.g Morris Worm: First usage of Buffer Overflow exploit</li>
<li>e.g Stuxnet: Targets Iranian nuclear centrifuges</li>
</ul>
<h3 id="trojans">Trojans</h3>
<ul>
<li>Package useful code with malicious code so that users will run the code</li>
<li><blockquote>
<p>Scareware</p>
</blockquote>
<ul>
<li>Windows IE phishing website warning</li>
</ul></li>
<li><blockquote>
<p>Ransomware</p>
</blockquote>
<ul>
<li>Cryptolocker demanded bitcoin to decrypt user’s files</li>
</ul></li>
</ul>
<h3 id="logic-bombs">Logic Bombs</h3>
<ul>
<li>Malicious code already on your computer</li>
<li>Executes after a trigger</li>
<li>Usually written by an insider to be triggered later</li>
<li>e.g Easter Eggs are non-malicious logic bombs</li>
</ul>
<h2 id="other-malicious-code">Other Malicious Code</h2>
<h3 id="web-bugs">Web Bugs</h3>
<ul>
<li>Object embedded in a web page that is from a different server than the webpage</li>
<li>Used for advertising tracking</li>
<li>Privacy violation</li>
</ul>
<h3 id="back-doors">Back Doors</h3>
<ul>
<li>Set of instructions designed to bypass the normal authentication mechanism</li>
<li>Examples
<ul>
<li>Debugging back door left in</li>
<li>Planted by Code Red worm</li>
<li>Port knocking</li>
</ul></li>
<li>Sources
<ul>
<li>Forgot to remove</li>
<li>Left for testing / maintenance / legal</li>
<li>Left for malicious reasons</li>
</ul></li>
</ul>
<h3 id="salami-attacks">Salami Attacks</h3>
<ul>
<li>Made of many small, inconsequential attacks</li>
<li>e.g Multiple transactions exploiting Round off error</li>
<li>e.g Multiple small charges to many cards</li>
</ul>
<h3 id="privilege-escalation">Privilege escalation</h3>
<ul>
<li>Goal of many attacks</li>
<li>Raises the privilege level of the attacker</li>
<li>e.g rlogin host -l userid=“value”
<ul>
<li>use “-froot” as the userid</li>
</ul></li>
<li>e.g Packet sniffing of HTTP packets</li>
</ul>
<h3 id="rootkit">Rootkit</h3>
<ul>
<li>Packed tools for privilege escalation</li>
<li>Has stealth capabilities to hide its own existence &lt;- key part
<ul>
<li>Cleans up log messages</li>
<li>Modifies <code>ls</code> and <code>ps</code> commands to not report files and processes belonging to the rootkit</li>
<li>Or even modifies the kernel to hide its existence</li>
</ul></li>
<li>e.g Sony XCP
<ul>
<li>Sony audio CDs contain an <code>autorun.exe</code> that modifies the cd driver to not read XCP-protected CDs</li>
<li>Made self difficult to find and uninstall</li>
</ul></li>
</ul>
<h3 id="keystroke-logging">Keystroke Logging</h3>
<ul>
<li>Almost all information input comes from keyboard</li>
<li>Can be accessed locally or sent to a remote machine</li>
<li>Installed by malware or family members</li>
<li>Types
<ul>
<li>Application-specific (to reduce noise and amount of data)</li>
<li>System</li>
<li>Hardware (between keyboard and computer. completely undetectable)</li>
</ul></li>
</ul>
<h3 id="interface-illusions">Interface Illusions</h3>
<ul>
<li>e.g scareware</li>
<li>Mimicks standard interfaces but actually does other behaviour</li>
<li>e.g Dragging scrollbar actually drags a program into the startup folder</li>
<li>We expect interfaces to look a certain way and trust them</li>
<li>Defense: hard to defend against. Focus on mitigation instead
<ul>
<li>OS requires ‘ctrl-alt-del’ to login</li>
<li>Banks have security images</li>
</ul></li>
</ul>
<h4 id="phishing">Phishing</h4>
<ul>
<li>Form of interface illusion</li>
<li>Malicious website that looks like a reputable one</li>
<li>Login information is given to the attacker</li>
<li>Detection:
<ul>
<li>Unusual email (requires urgent action)</li>
<li>Unusual URL</li>
<li>Attachments with uncommon names</li>
<li>Typos, unusual wording</li>
<li>HTTPS does not guarentee</li>
</ul></li>
<li>Spearphishing = phishing attack targetting specific person</li>
</ul>
<h3 id="man-in-the-middle-attacks">Man-in-the-middle attacks</h3>
<ul>
<li>Category for keyboard logging, inferface illusions and phishing</li>
<li>The website/program/system you’re communicating with is fake</li>
<li>User doesn’t notice problems because the program passes things on the actual site</li>
<li>Can edit output to hide it’s attack</li>
</ul>
<h2 id="non-malicious-flaws">Non-malicious Flaws</h2>
<h3 id="covert-channels">Covert Channels</h3>
<ul>
<li>Transfering data through a channel not meant to transmit that information</li>
</ul>
<h3 id="side-channels">Side Channels</h3>
<ul>
<li>Watch how computer behaves when processing sensitive data</li>
<li>Usually need to be in physical vicinity</li>
<li>e.g
<ul>
<li>Bandwidth consumptions</li>
<li>CPU fan noise / temperature</li>
<li>Shoulder-surfing</li>
<li>Reflections: Look at reflection in the mirror or glasses
<ul>
<li>Telescope + Camera &lt; $2000</li>
</ul></li>
</ul></li>
</ul>
<h2 id="controls-against-security-flaws-in-program">Controls against security flaws in program</h2>
<ul>
<li>Add security controls to all stages of the software lifecycle</li>
</ul>
<h3 id="design">Design</h3>
<ul>
<li>Modularity
<ul>
<li>Break problems into small pieces responsible for a single subtask</li>
<li>Easier to check for flaws</li>
<li>Have low coupling between modules</li>
</ul></li>
<li>Encapsulation
<ul>
<li>Have modules be self-contained</li>
<li>Reduces coupling</li>
</ul></li>
<li>Information Hiding
<ul>
<li>Internals of one module shouldn’t be visible to the other modules</li>
</ul></li>
<li>Mutual Suspicion
<ul>
<li>Check inputs before processing</li>
<li>Prevents corrupted data in one module from corrupting other modules</li>
</ul></li>
<li>Confinement
<ul>
<li>Sandbox potentially untrustworthy code</li>
</ul></li>
</ul>
<h3 id="implementation">Implementation</h3>
<ul>
<li>Don’t use C</li>
<li>Static code analysis
<ul>
<li>Existing software products for various languages</li>
</ul></li>
<li>Formal methods
<ul>
<li>Prove code does what it says it does</li>
<li>Difficult to do</li>
</ul></li>
<li>Genetic diversity
<ul>
<li>Use different HTTP servers, code, etc</li>
</ul></li>
</ul>
<h3 id="change-management">Change Management</h3>
<ul>
<li>Track source code / config changes</li>
</ul>
<h3 id="code-review">Code Review</h3>
<ul>
<li>Most effective method</li>
<li>Code Review Types
<ul>
<li>Reviewers look over the code</li>
<li>Guided walk-through: Author explains code to reviewers</li>
</ul></li>
<li>Reviewers might get lazy and miss things
<ul>
<li>Solution: Add easter-egg vulnerabilities</li>
</ul></li>
</ul>
<h3 id="testing">Testing</h3>
<ul>
<li>Black-box testing:
<ul>
<li>Test completed function / module / program / system without knowing the implementation</li>
<li>Fuzz-testing: give completely random data as input
<ul>
<li>Will often cause crashes (availability concern)</li>
</ul></li>
</ul></li>
<li>White-box testing:
<ul>
<li>Testing while knowing design and implementation</li>
<li>Good for regression testing (write a test suite and re-run tests on new versions)</li>
</ul></li>
</ul>
<h3 id="documentation">Documentation</h3>
<ul>
<li>Write down and explain design choices</li>
<li>Record things that didn’t work</li>
</ul>
<h3 id="maintenance">Maintenance</h3>
<ul>
<li>Should have no flaws when the product is done</li>
<li>There will be flaws</li>
</ul>
<h3 id="standards-process-audit">Standards, process, audit</h3>
<ul>
<li>Org should have <em>standards</em> for how each stage of software development is done</li>
<li><em>Processes</em> specify how the standards are enforced</li>
<li><em>Audits</em> verify that processes are followed</li>
</ul>
<h1 id="operating-system-security">Operating System Security</h1>
<h2 id="operating-systems">Operating Systems</h2>
<ul>
<li>Allows users to access to different resources in a shared way</li>
<li>Identification and authorization are needed to control access</li>
<li>Protects users from each other and themselves
<ul>
<li>Threats: attacks, mistakes, resource over comsumption, malware</li>
</ul></li>
</ul>
<h2 id="seperation">Seperation</h2>
<ul>
<li>Physical seperation
<ul>
<li>User difference physical resources</li>
<li>Easy implementation</li>
<li>Expensive and inefficient</li>
</ul></li>
<li>Temporal seperation
<ul>
<li>Execute different programs at different times</li>
</ul></li>
<li>Logical seperation
<ul>
<li>User cannot see other users</li>
</ul></li>
<li>Cryptographic seperation
<ul>
<li>Encrypt data so others cannot read it</li>
<li>Complex</li>
</ul></li>
</ul>
<h2 id="sharing">Sharing</h2>
<ul>
<li>Some resources should be shared (e.g library routines, files)</li>
<li>Flexible sharing: ability for some files to be shared, but not all</li>
</ul>
<h2 id="memory-and-address-protection">Memory and Address Protection</h2>
<ul>
<li>Prevent one program from corrupting others</li>
<li>Use virtual addresses instead of physical</li>
<li>Techniques
<ul>
<li>Fence register
<ul>
<li>Exception if user tries to access memory below a ‘fence’</li>
<li>Protects system from user</li>
<li>Single user only</li>
</ul></li>
<li>Base/bounds register pair
<ul>
<li>Exception if user accesses memory below base / above bounds</li>
<li>Different values for each program</li>
<li>Limited flexibility</li>
</ul></li>
<li>Tagged architecture
<ul>
<li>Additional bit in memory to indicate access rights</li>
<li>Flexible</li>
<li>Large overhead</li>
</ul></li>
<li>Segmentation
<ul>
<li>Each program has multiple address spaces</li>
<li>Segments for code, data, stack</li>
<li>Virtual addresses contain a segment name and offset within segment</li>
<li>Segment table maps segment names to physical addresses</li>
<li>Segment table tracks protection attributes</li>
<li>Pro: Addresses are hardware checked for protection
<ul>
<li>Different levels of protection are possible</li>
<li>Users can share access</li>
</ul></li>
<li>Con: External fragmentation
<ul>
<li>Costly out-of-bounds checks</li>
</ul></li>
</ul></li>
<li>Paging
<ul>
<li>Virtual memory is divided into pages</li>
<li>Physical memory is divided into frames</li>
<li>Virtual addresses contain page number and offset</li>
<li>Page table maps page number to physical address</li>
<li>Page table tracks protection attributes</li>
<li>Pro: Addresses are hardware checked for protection
<ul>
<li>Users can share access</li>
<li>Pages can be moved to disk</li>
</ul></li>
<li>Con: Internal fragmentation
<ul>
<li>Cannot have different levels of protection</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<h2 id="access-control">Access Control</h2>
<ul>
<li>Goals
<ul>
<li>Check every access</li>
<li>Enforce least privilege</li>
<li>Verify acceptable use</li>
</ul></li>
</ul>
<h3 id="access-control-structures">Access Control Structures</h3>
<h4 id="access-control-matrix">Access Control Matrix</h4>
<ul>
<li>Objects (O): Files / database records</li>
<li>Subjects (S): users, processes</li>
<li>Rights (R): read, write, execute, own</li>
<li>Table permissions for each user and file</li>
<li>Matrix very sparse</li>
</ul>
<h4 id="access-control-list">Access Control List</h4>
<ul>
<li>Implementation of access control matrix</li>
<li>More space efficient</li>
<li>Each object has a list of subjects and their rights</li>
<li>Use cases
<ul>
<li>Determine set of allowed users per object: fast</li>
<li>Determine set of objects a user can access: slow</li>
<li>Revoke a user’s access right to an object or all objects: 1 object: medium, all objects: slow</li>
</ul></li>
</ul>
<h4 id="capabilities">Capabilities</h4>
<ul>
<li>A capability is an <strong>unforgeable token</strong> that gives its owner some access rights to an object</li>
<li>More versatile than access control lists</li>
<li>Can be transferable (if anonymous)</li>
<li>e.g seL4 is an OS that uses capabilities</li>
<li>Use cases
<ul>
<li>Determine set of allowed users per object: slow</li>
<li>Determine set of objects a user can access: fast</li>
<li>Revoke a user’s access right to an object or all objects: 1 object: fast, all objects: slow</li>
</ul></li>
</ul>
<h4 id="combined-acl-and-capabilities">Combined ACL and Capabilities</h4>
<ul>
<li>Faster access checking</li>
<li>e.g UNIX: every file has an ACL, if access is granted, caller is given a capability stored in kernel</li>
<li>Problem: TOCTTOU vulnerability</li>
</ul>
<h4 id="role-based-access-control">Role-based access control</h4>
<ul>
<li>Access depends on group that user belongs in</li>
<li>Advantage: Role changes are easy to change permissions for</li>
<li>Extensions: Hierarchical roles
<ul>
<li>Multiple roles</li>
<li>Separation of duty</li>
</ul></li>
</ul>
<h2 id="user-authentication">User Authentication</h2>
<ul>
<li>Computer systems must <em>identify</em> and <em>authenticate</em> users before <em>authorizing</em> them</li>
<li><em>Identification</em>: Who are you</li>
<li><em>Authentication</em>: Prove identity</li>
</ul>
<h3 id="authentication-factors">Authentication Factors</h3>
<ul>
<li>4 classes of authentication factors using something that the user…
<ol type="1">
<li>Knows (e.g Password, PIN, secret question)</li>
<li>Has (ATM card, badge, browser cookie, physical key)</li>
<li>Is (Biometrics)</li>
<li>Context (Location, time, devices in proximity)</li>
</ol></li>
<li>Combine factors for multifactor / 2-factor authentication</li>
</ul>
<h4 id="passwords">Passwords</h4>
<ul>
<li>Oldest authentication mechanism</li>
<li>Usability problems:
<ul>
<li>Inconvenient</li>
<li>Password composition rules</li>
<li>Updating shared passwords</li>
</ul></li>
<li>Security problems
<ul>
<li>Leaked passwords are easy to use</li>
<li>Shoulder surfing</li>
<li>Keystroke logging</li>
<li>Interface illusions</li>
<li>Password re-use</li>
<li>Password guessing</li>
<li>Interception attacks</li>
</ul></li>
</ul>
<h5 id="password-guessing">Password guessing</h5>
<ul>
<li>Brute-force
<ul>
<li>$2700 can break a 8 character password in 6 minutes</li>
<li>Exponential difficulty depending on number of characters</li>
</ul></li>
<li>Dictionary attack
<ul>
<li>Passwords are not uniformly random</li>
<li>Prefix or postfix numbers</li>
</ul></li>
<li>Offline attack
<ul>
<li>Requires access to encrypted password file</li>
</ul></li>
<li>Online attack
<ul>
<li>Detectable by bank server (n login attempts)</li>
</ul></li>
<li>Defense: use a MAC (hash with a key)
<ul>
<li>Key must be stored elsewhere</li>
</ul></li>
</ul>
<h5 id="password-hygiene">Password Hygiene</h5>
<ul>
<li>Use a password manager
<ul>
<li>At least for low- and medium-security passwords</li>
<li>Helps agaisnt phishing attacks</li>
</ul></li>
<li>Or Use a pass phrase of randomly chosen words
<ul>
<li>More random and secure</li>
</ul></li>
<li>Have site-specific passwords</li>
<li>Don’t reveal passwords to others</li>
<li>Don’t enter passwords on public computers</li>
</ul>
<h5 id="password-policies">Password Policies</h5>
<ul>
<li>No composition rules</li>
<li>8 &lt;= len &lt;= &gt;64</li>
<li>Allows any characters including space, unicode, emoji</li>
<li>Blacklist common passwords, compromised passwords</li>
<li>Avoid password hints</li>
<li>Dont require password cycling</li>
<li>Allow copy-pasting passwords in fields</li>
<li>Use two-factore authentication
<ul>
<li>Don’t use SMS: it can be intercepted</li>
</ul></li>
</ul>
<h5 id="storing-passwords">Storing Passwords</h5>
<ul>
<li>Store a <em>digital fingerprint</em> of the password, not plain-text</li>
<li>Use a crytographic hash to create the fingerprint
<ul>
<li>Don’t use standard ones (SHA-1, SHA-512) that are cheap to compute</li>
<li>Use an iterated hash function that are expensive to compute (bcrypt) and lots of memory (scrypt)</li>
<li>^Same requirements of cryptocurrencies</li>
</ul></li>
<li>Include a user-specific salt in the fingerprint
<ul>
<li>This changes the fingerprints even if the password is the same</li>
</ul></li>
</ul>
<h5 id="password-recovery">Password Recovery</h5>
<ul>
<li>Not recommended</li>
<li>Cannot be recovered from the fingerprint (otherwise the attacker can too)</li>
<li>Encrypt the password so that it can be decrypted</li>
<li>e.g Adobe Password Hack when Adobe did not use a secure password encryption</li>
</ul>
<h4 id="alternative-passwords">Alternative Passwords</h4>
<ul>
<li>Android unlock patterns
<ul>
<li>Easy to dictionary attack</li>
<li>Can’t be automated</li>
</ul></li>
<li>Graphical passwords
<ul>
<li>e.g Re-Identify a picture</li>
<li>e.g Choose a set of places in a picture</li>
<li>Problem: Shoulder surfing</li>
</ul></li>
<li>Biometrics
<ul>
<li>Can accept someone else that is sufficiently close</li>
<li>Doesn’t work well for remote authentication</li>
<li>Identification is harder (expensive search problem)
<ul>
<li>Base rate fallacy for identifying criminals</li>
</ul></li>
<li>Privacy issues</li>
<li>Accuracy issues: False negatives, appearance changes</li>
<li>Secrecy: Face, fingerprints aren’t very secret</li>
<li>Legal Protection: Police can make you use your finger, but not reveal your password</li>
</ul></li>
</ul>
<blockquote>
<p>End Midterm material No security policies and models (it’s outdated XD) Format: Written, no calculators Study: Look at notes &gt; Definitions &gt; No fine details (names of malware) &gt; High level understanding of assignment</p>
</blockquote>
<h2 id="security-policies-and-models">Security Policies and Models</h2>
<h3 id="trusted-operating-systems">Trusted Operating Systems</h3>
<ul>
<li>We have <em>confidence</em> that it provides security services
<ul>
<li>Memory and file protection</li>
<li>Access control and user authentication</li>
</ul></li>
<li>4 factors
<ul>
<li>Policy: rules outlining what’s secured and why</li>
<li>Model: implements the policy</li>
<li>Design: specs of how the model is implemented</li>
<li>Trust: assurance implementation is to design</li>
</ul></li>
</ul>
<h3 id="trusted-software">Trusted Software</h3>
<ul>
<li>Trust that code does what is expected and nothing more</li>
<li>Factors
<ul>
<li>Functional correctness: works correctly</li>
<li>Enforcement of integrity: wrong inputs don’t impact data correctness</li>
<li>Limited privilege: access rights are minimized</li>
<li>Appropriate confidence level: rated as required by environment</li>
</ul></li>
</ul>
<h3 id="security-policies">Security Policies</h3>
<h4 id="military">Military</h4>
<ul>
<li>Everything has a sensitivity
<ul>
<li>“Top Secret” &gt; “Secret” &gt; “Confidential” &gt; “Unclassified”</li>
</ul></li>
<li>Everything has 1+ compartment
<ul>
<li>i.e Groups</li>
</ul></li>
<li>Subject s can access object o if and only if
<ul>
<li>level(s) &gt;= level(o)</li>
<li>compartments(s) <span class="math inline">⊇</span> comparments(o)</li>
</ul></li>
</ul>
<h4 id="commercial">Commercial</h4>
<ul>
<li>Classification levels different
<ul>
<li>e.g external vs internal</li>
</ul></li>
<li>Clearance levels less formally defined</li>
</ul>
<h4 id="other">Other</h4>
<ul>
<li>Non confidentiality policies</li>
<li>Integrity policy: Clark-Wilson Security Policy
<ul>
<li>Use <em>well-formed transactions</em> to ensure state is always consistent</li>
</ul></li>
<li>Conflicts of interest: Chinese Wall Security Policy
<ul>
<li>Once you are on a side, it is hard to switch</li>
<li>Once you access information about a company, you cannot access information of similar companies</li>
<li>Requirements
<ul>
<li>History of object access</li>
<li>Changing access rights</li>
</ul></li>
<li>use cases: Consulting, legal, accounting</li>
<li><em>ss-property</em>: Subject <code>s</code> can access object <code>o</code> if and only if
<ul>
<li>each previously accessed object belongs to the same company of <code>o</code> or belongs to a different kind of company</li>
</ul></li>
<li><em>*-property</em>: For <code>s</code> to write to <code>o</code>,
<ul>
<li>all objects readable by <code>s</code> belong to the same company as <code>o</code> or have been sanitized</li>
<li>This prevents indirect information flow</li>
</ul></li>
</ul></li>
</ul>
<h3 id="security-models">Security Models</h3>
<ul>
<li>2 multilevel security (MLS) policies</li>
</ul>
<h4 id="side-lattice">Side: Lattice</h4>
<ul>
<li>Multilevel security (MLS) policies contain clearance and classification levels</li>
</ul>
<h4 id="bell-la-padula-confidentiality-model">Bell-La Padula Confidentiality Model</h4>
<ul>
<li>Regulates information flow in lattice</li>
<li>Information only flows <em>up</em></li>
<li><em>ss-property</em>: “No read up”
<ul>
<li><code>s</code> can only read <code>o</code> if</li>
</ul></li>
<li><em>*-property</em>: “No write down”</li>
</ul>
<h4 id="biba-integrity-model">Biba Integrity Model</h4>
<ul>
<li>Prevents inappropriate data modification</li>
<li>Write:
<ul>
<li><code>s</code> can modify <code>o</code> if ….</li>
</ul></li>
<li>Read: TODO</li>
<li>Very restrictive access rules</li>
<li>Information flows down</li>
</ul>
<h5 id="low-watermark-property">Low Watermark Property</h5>
<h2 id="todo-rest-of-security-policies-and-models">TODO: Rest of Security policies and models</h2>
<h2 id="trusted-operating-system-design">Trusted operating system design</h2>
<ul>
<li>Reading</li>
</ul>
<h3 id="security-design-principles">Security design principles</h3>
<ul>
<li>Least privilege
<ul>
<li>Operate using fewest privileges possible</li>
</ul></li>
<li>Economy of mechanism
<ul>
<li>Protection mechanism should be as simple as possible</li>
</ul></li>
<li>Open design
<ul>
<li>Avoid security by obscurity</li>
<li>Don’t use secret algorithms</li>
</ul></li>
<li>Complete mediation
<ul>
<li>Every access attempt must be checked (TOCTTOU)</li>
</ul></li>
<li>Permission based / fail-safe defaults
<ul>
<li>Default to no access</li>
</ul></li>
<li>Seperation of privileges
<ul>
<li>Check multiple conditions to get access</li>
</ul></li>
<li>Least common mechanism</li>
<li>Ease of use</li>
</ul>
<h3 id="features-of-trusted-os">Features of Trusted OS</h3>
<ul>
<li>Identification and authentication</li>
<li>Access control
<ul>
<li>Mandatory access control (MAC)
<ul>
<li>Central authority decides what people can access</li>
<li>Military environments</li>
</ul></li>
<li>Discretionary access control (DAC)
<ul>
<li>Object owners have control over who can access it</li>
<li>e.g Give others access to your home directory</li>
</ul></li>
<li>RBAC</li>
</ul></li>
<li>Object reuse protection
<ul>
<li>Erase returned memory before giving it to other users</li>
<li><strong>Hidden data</strong>: data you think you deleted, but is still hidden somewhere</li>
</ul></li>
<li>Complete mediation
<ul>
<li>All accesses must be checked</li>
</ul></li>
<li>Trusted path
<ul>
<li>Give assurance that keystrokes and mouse clicks are sent to the legitimate receiver application</li>
</ul></li>
<li>Accountability and audit
<ul>
<li>Keep audit log of security-related events</li>
</ul></li>
<li>Intrusion detection
<ul>
<li>OS should detect intrusions</li>
<li>Look for actual behaviour that (does not) correlate with normal behaviour</li>
</ul></li>
</ul>
<h3 id="trusted-computing-base-tcb">Trusted computing base (TCB)</h3>
<ul>
<li>Part of trusted OS necessary to enforce OS security policy</li>
<li>Runs below OS kernel</li>
<li>Rings
<ul>
<li>Things in ring <code>n</code> can only access memory/instructions in rings &gt;= <code>n</code></li>
<li>Rings:
<ol type="1">
<li>hardware</li>
<li>security kernel</li>
<li>operating system</li>
<li>user tasks</li>
</ol></li>
</ul></li>
<li>Reference monitor
<ul>
<li>Collection of access controls for devices, files, memory, IPC, et.c</li>
<li>Need to be
<ul>
<li>tamperproof</li>
<li>unbypassable</li>
<li>analyzable</li>
</ul></li>
</ul></li>
</ul>
<h3 id="virtualization">Virtualization</h3>
<ul>
<li>Virtual memory
<ul>
<li>Illusion that every device is the only device that has access to the machine</li>
</ul></li>
<li>Virtual machine
<ul>
<li>Sandbox for applications</li>
<li>Higher security</li>
<li>Attackers can launch your OS in a VM
<ul>
<li>Hard to detect, and attackers can see everything</li>
</ul></li>
</ul></li>
</ul>
<h3 id="application-insulation">Application Insulation</h3>
<ul>
<li>Use encryption to sheild memory of one application from another</li>
<li>Seperate application into trusted and untrusted code</li>
<li>API to communicate between untrusted and trusted code</li>
<li>e.g Intel SGX (Software guard extension)
<ul>
<li>CPU stores a key for encryption</li>
<li>Originally for DRM -&gt; realized DRM is not worth it</li>
</ul></li>
<li>e.g AMD memory encryption</li>
</ul>
<h3 id="signal-contact-discovery">Signal Contact Discovery</h3>
<ul>
<li>Signal = contacts?</li>
<li>How do you know something has signal, so that you can use it to communicate?
<ul>
<li>Users send hash of their contacts phone numbers to signal server</li>
<li>Server matches up hashes to determine if two users can use Signal send encrypted numbers</li>
</ul></li>
<li>Hashes are not salted so attackers can easily construct social graphs</li>
<li>Solution: Seperate out trusted and untrusted code
<ul>
<li>Secure Enclave (i.e SGX) receives encrypted contacts information and decrypts it</li>
<li>Rest of server does not have access to decrypted information</li>
<li>^ <strong>Remote attestation</strong></li>
</ul></li>
</ul>
<h3 id="least-privilege-in-popular-os">Least Privilege in popular OS</h3>
<ul>
<li>OS privilege control was really bad</li>
<li>Windows:
<ul>
<li>pre-NT: any user can do anything</li>
<li>pre-Vista: needs admin account to do some things (but everyone just ran as admin)</li>
<li>Vista: temporary access rights, integrity levels</li>
</ul></li>
<li>UNIX:
<ul>
<li>root has every access</li>
<li>root was removed in some later UNIX OS</li>
</ul></li>
<li>iOS:
<ul>
<li>Original iphone had user run everything as root (only 1st party apps, so more ok)</li>
<li>Every app had a user id with different access</li>
</ul></li>
</ul>
<h3 id="seperation-techniques">Seperation Techniques</h3>
<h4 id="chroot">Chroot</h4>
<ul>
<li><code>chroot /new/root command</code></li>
<li>Create a ‘jail’ which is the only space the command is allow to touch</li>
<li>The root directory for the command is changed to something else</li>
<li>Can be broken out of</li>
</ul>
<h4 id="compartmentalization">Compartmentalization</h4>
<ul>
<li>Split application into parts that have least privilege</li>
<li>Have an unprivileged, jailed child that takes unsafe unput</li>
</ul>
<h4 id="setuid-suid-bit"><code>setuid</code> / <code>suid</code> bit</h4>
<ul>
<li>Makes the executable run under identity of the owner, not caller
<ul>
<li>e.g <code>pwgen</code> runs under <code>root</code>, not <code>user</code></li>
</ul></li>
<li>Vulnerable to privilege escalation attack</li>
<li>Confused deputy attack: impersonate another user</li>
</ul>
<h3 id="assurance">Assurance</h3>
<ul>
<li>How to convince people an OS is secure?</li>
<li>Testing
<ul>
<li>Cannot prove no problems exist</li>
<li>(halting problem…?)</li>
</ul></li>
<li>Formal verification
<ul>
<li>Use math to prove OS correctness</li>
<li>Not advanced enough for large OSs</li>
</ul></li>
<li>Validation
<ul>
<li>Requirements checking, design, code reviews, system testing</li>
</ul></li>
<li>Evaluation
<ul>
<li>Have a trusted entity evaluate and certify the OS</li>
<li><em>Orange Book</em> gives a D to A1 rating</li>
<li><em>Common Criteria</em> replaces the Orange book
<ul>
<li>Has Protection Profiles</li>
<li>Rating from EAL1 (worst) to EAL7 (best)</li>
</ul></li>
<li>Most OSs have C rating</li>
</ul></li>
</ul>
<h1 id="network-security">Network Security</h1>
<ul>
<li>Networks are not built with security in mind</li>
</ul>
<h2 id="network-concepts">Network Concepts</h2>
<h3 id="architecture">Architecture</h3>
<ul>
<li>Information is routed between endpoints
<ul>
<li>e.g router, server, mobile, doorbell, thermostat</li>
</ul></li>
<li>local ISP -&gt; regional ISP -&gt; backbone -&gt; regional ISP -&gt; company network</li>
</ul>
<h3 id="characteristics">Characteristics</h3>
<ul>
<li>No single entity controls the internet
<ul>
<li>fuzzy… Amazon going down would take down a lot of websites</li>
</ul></li>
<li>Traffic flows through nodes controlled by different entities</li>
<li>Cannot control path of traffic flow</li>
<li>TCP/IP is a network protocol</li>
</ul>
<h4 id="tcpip-protocol-suite">TCP/IP Protocol Suite</h4>
<ul>
<li>4 layers
<ul>
<li>Link
<ul>
<li>How things are physically connected (wifi, ethernet)</li>
</ul></li>
<li>Network
<ul>
<li>IP addresses</li>
</ul></li>
<li>Transport
<ul>
<li>TCP or UDP</li>
<li>Control information</li>
</ul></li>
<li>Application
<ul>
<li>HTTP, FTP, email, SSL</li>
</ul></li>
</ul></li>
<li>Was designed for local network connections between trusted entities</li>
<li>Design did not address malicious errors</li>
</ul>
<h2 id="threats-in-networks">Threats in Networks</h2>
<ul>
<li>“No one knows if you’re a dog on the internet”</li>
<li>Things on the internet are very visible</li>
<li>DOS: Attack on availability</li>
</ul>
<h3 id="confidentiality-attacks">Confidentiality Attacks</h3>
<h4 id="port-scan">Port Scan</h4>
<ul>
<li>Attacker sees which ports are open on a server
<ul>
<li>Indicates which applications are running on the server</li>
</ul></li>
<li>Server responses can reveal software versions being used</li>
<li>Loose lipped Login pages can reveal which user_id’s are valid
<ul>
<li>Timing Attack: Response times differ if the user exists because password hashing takes time</li>
<li>e.g Ashley Madison has a different password recovery screen if the email exists</li>
</ul></li>
</ul>
<h4 id="intelligence">Intelligence</h4>
<ul>
<li>Social Engineering
<ul>
<li>e.g Twitter handle attacks</li>
<li>Attacker impersonates the user and attempts to reset password</li>
</ul></li>
<li>Dumpster Diving
<ul>
<li>Collecting as much information as possible</li>
</ul></li>
<li>Eavesdropping</li>
<li>Google
<ul>
<li>Lots of information on the internet that can be found</li>
</ul></li>
<li>Social Networks
<ul>
<li>Lots of personal information on social networks</li>
</ul></li>
</ul>
<h4 id="eavesdropping">Eavesdropping</h4>
<ul>
<li>Owner of node can monitor communication flowing through node
<ul>
<li>End-to-end encryption makes this better</li>
</ul></li>
<li>Active wiretapping: modification or fabrication of communication</li>
<li>Communication can be accidentally sent to an attacker’s node</li>
<li>Assume your communication is wiretapped</li>
</ul>
<h5 id="communication-media">Communication Media</h5>
<ul>
<li>Copper cable
<ul>
<li>Inductance allows nearby attackers to eavesdrop</li>
<li>Can also splice in a secondary cable</li>
</ul></li>
<li>Optical fibre
<ul>
<li>No inductance, and splicing will cause detectable signal loss</li>
</ul></li>
<li>Microwave / Satellite communication
<ul>
<li>Attackers close to receiver can eavesdrop</li>
</ul></li>
<li>These attacks involve physical expenses and effort</li>
<li>WiFi
<ul>
<li>Easily intercepted by anyone with a WiFi-capable device with the right software</li>
<li>Can be tapped by people kilometers away</li>
</ul></li>
</ul>
<h4 id="misdelivered-information">Misdelivered information</h4>
<ul>
<li>Local Area Network (LAN)
<ul>
<li>Connects all computers in a company</li>
<li>Packets may be sent to multiple nodes</li>
<li>Simple configuration to keep the packets instead of deleting them</li>
</ul></li>
<li>Email
<ul>
<li>Wrongly addressed emails</li>
<li>Accidental reply-all</li>
</ul></li>
</ul>
<h4 id="impersonation">Impersonation</h4>
<ul>
<li>Impersonate people by stealing their password
<ul>
<li>Guessing password</li>
<li>Using default passwords</li>
<li>Password sniffing (e.g unsecured networks)</li>
<li>Social engineering</li>
</ul></li>
<li>Exploit trust between machines or accounts
<ul>
<li><code>rhosts</code> allows (user A on machine X) to specify (user B on machine Y) can act as (A on X) without a password</li>
<li><code>ssh</code> has a similar mechanic in <code>.ssh/authorized_keys</code></li>
</ul></li>
</ul>
<h4 id="spoofing">Spoofing</h4>
<ul>
<li>An Object masquerades as another one</li>
<li>URL spoofing (phishing websites)
<ul>
<li>Exploit typos, ambiguities, similarities</li>
<li>Defence: buy out domains that look similar</li>
</ul></li>
<li>“Evil Twin” attack
<ul>
<li>Create WiFi access points that are named the same</li>
<li>You can get people’s credentials when they log into your network</li>
</ul></li>
<li>Cellphone tower spoofing (MSI catchers)
<ul>
<li>Gets identities of people</li>
</ul></li>
<li>Session hijacking
<ul>
<li>TCP protocol has state that keeps track of lost packets</li>
<li>Attacker can perform TCP hijacking and masquerade as one of the endpoints
<ul>
<li>Also used to bypass censorship firewalls</li>
</ul></li>
<li>Cookies can be sniffed or stolen and used to masquerade as the client</li>
</ul></li>
<li>Man-in-the-middle attacks
<ul>
<li>Attacker becomes a stealth intermediate node, and passes traffic on to the end node</li>
</ul></li>
</ul>
<h4 id="traffic-analysis">Traffic Analysis</h4>
<ul>
<li>The existence of communication is sensitive
<ul>
<li>e.g Whistle blowers</li>
<li>e.g Large pizza order = meeting</li>
</ul></li>
<li>TCP/IP packets include sender and receiver node information
<ul>
<li>Easy to analyze</li>
</ul></li>
</ul>
<h3 id="integrity-attacks">Integrity Attacks</h3>
<ul>
<li>Attackers can modify packs while they are being transmitted
<ul>
<li>Change payloads</li>
<li>Change sender or receiver</li>
<li>Replay previous packets</li>
<li>Delete or create packets</li>
</ul></li>
<li>There are checks to detect natural packet drops and corruption
<ul>
<li>e.g TCP checksum</li>
<li>Attackers can get around the checks</li>
</ul></li>
<li>DNS cache poisoning
<ul>
<li>Domain Name System maps host names to IP addresses</li>
<li>Attacker can create wrong mappings
<ul>
<li>Run own DNS server</li>
<li>Modify traffic</li>
</ul></li>
<li>Defence: DNSSEC
<ul>
<li>Still being rolled out</li>
</ul></li>
</ul></li>
</ul>
<h4 id="protocol-failures">Protocol Failures</h4>
<ul>
<li>TCP/IP assumes all nodes implement protocols faithfully</li>
<li>Congestion control that asks a sender node to slow down can be ignored</li>
<li>Check that packets are well formatted
<ul>
<li>Vulnerable to out of bounds errors from bad lengths</li>
</ul></li>
<li>Some protocols are complex and hard to implement correctly
<ul>
<li>e.g TLS</li>
</ul></li>
<li>Some protocols are just broken
<ul>
<li>e.g WEP</li>
</ul></li>
</ul>
<h3 id="website-vulnerabilities">Website Vulnerabilities</h3>
<ul>
<li>Website defacement</li>
<li>HTML response can reveal server version information (loose-lips)</li>
<li>Malicious URLs can be sent to a server
<ul>
<li>Buffer overflow attacks</li>
<li>Sensitive file access</li>
<li>Feed malicious input to a server-side script</li>
</ul></li>
<li>HTTP doesn’t have state, and relies on client to keep state
<ul>
<li>Attackers can modify the state</li>
</ul></li>
<li>XSS, CSRF</li>
<li>Embedding HTML code into someone else’s webpage</li>
</ul>
<h4 id="denial-of-service-dos">Denial of Service (DoS)</h4>
<ul>
<li>Damaging or congesting internet infrastructure</li>
<li>Cut a wire or jam a wireless signal (rare)</li>
<li>Flood a node by overloading its Internet connection (common)
<ul>
<li>Ping flood
<ul>
<li>Send a packet to the victim that they must respond to</li>
<li>Overload with ping responses</li>
</ul></li>
<li>Smurf attack
<ul>
<li>Spoof ping sender address to many machines</li>
<li>Overload with ping replies</li>
</ul></li>
</ul></li>
<li>Exploit implementation details of a node
<ul>
<li>SYN flood
<ul>
<li>TCP initializes state by sending (SYN, SYN-ACK, ACK) packets</li>
<li>Can send many SYNs without any ACKS and server over queues them</li>
</ul></li>
<li>Network traffic is sent in chunks
<ul>
<li>Send packet fragments that cannot be reassembled</li>
</ul></li>
<li>Craft packets that hash to the same bucket
<ul>
<li>Causes inefficiencies</li>
<li>Need to know the hash function</li>
</ul></li>
<li>Back hole attack
<ul>
<li>Packet routing is a distributed protocol</li>
<li>Each router reports its cost to reach destinations</li>
<li>Malicious router can report a low cost to victim to get the traffic</li>
<li>Actually drops all the traffic so victim doesn’t get anything</li>
<li>e.g YouTube block in Pakistan</li>
</ul></li>
<li>DNS attacks
<ul>
<li>Poison DNS cache</li>
<li>Packets get routed to the wrong host</li>
</ul></li>
</ul></li>
<li>Reflection and Amplification DDOS
<ul>
<li>Victim gets flooded with traffic from many nodes</li>
<li>Amplification: small data results in large work / response
<ul>
<li>Attacker does less work than victim</li>
</ul></li>
<li>Reflection: spoof source address to redirect queries</li>
<li>Difficult to defend
<ul>
<li>Actually following protocol, just with unreasonable volume</li>
</ul></li>
</ul></li>
<li>Distributed Denial of Service (DDOS)
<ul>
<li>Launching DOS attacks from many machines</li>
<li>Hard to block</li>
<li>Usually from unknowing machines that were infected with malware</li>
</ul></li>
<li>Botnets
<ul>
<li>Machines get infected with malware and become a ‘zombie’/‘bot’
<ul>
<li>Waits for an attack command</li>
</ul></li>
<li>Current botnets are very sophisticated
<ul>
<li>more stealthy</li>
<li>don’t have a central command node</li>
<li>Dynamic and redundant control infrastructure
<ul>
<li>To allow reuse</li>
<li>P2P system to distribute update</li>
<li><em>Fast Flux</em>
<ul>
<li>Keep changing ip address</li>
</ul></li>
<li>Domain Generation Algorithm
<ul>
<li>Have a large collection of domain names</li>
<li>Connect to a different domain everyday</li>
</ul></li>
</ul></li>
</ul></li>
<li>Worms are now written for profit
<ul>
<li>Rented out to criminal organizations</li>
<li>Spreads slowly and waits before activating</li>
</ul></li>
<li>e.g Storm, Mirai <!-- No active code / script kiddies --></li>
</ul></li>
</ul>
<h2 id="network-security-controls">Network security controls</h2>
<h3 id="design-and-implementation">Design and implementation</h3>
<ul>
<li>Same polices for secure programs apply
<ul>
<li>Economic of mechanism</li>
<li>Always check inputs
<ul>
<li>Use a whitelist, not a blacklist</li>
</ul></li>
</ul></li>
<li>Segmentation and separation
<ul>
<li>Don’t put all company servers on a single machine</li>
<li>Have different access requirements for different machines</li>
<li>Modularize services</li>
<li>e.g Public accessible web server should not be trusted</li>
</ul></li>
<li>Redundancy
<ul>
<li>Have backup disks, power, locations</li>
<li>Backup frequently so its easier to recover</li>
</ul></li>
<li>Access controls
<ul>
<li>Have ACLs on routers
<ul>
<li>Can configure ACL to block attacking addresses</li>
</ul></li>
<li>Firewalls
<ul>
<li>Can do more specific filtering</li>
</ul></li>
</ul></li>
</ul>
<h2 id="firewalls">Firewalls</h2>
<ul>
<li>All traffic in/out of company goes through choke points where it is checked</li>
<li><em>Choke points</em> examine traffic and may refuse access
<ul>
<li>Whitelist or blacklist approach</li>
</ul></li>
<li>Does not protect from attacks within the network
<ul>
<li>Need additional defences</li>
</ul></li>
<li>Firewalls can be attacked too</li>
<li>Types:
<ul>
<li>Packet filtering gateways
<ul>
<li>Makes fast decision based on header of packet
<ul>
<li>Source, destination, Port numbers</li>
</ul></li>
<li>Does not look at packet payload</li>
<li>Can detect spoofed traffic
<ul>
<li>Egress filtering: outgoing packet but origin not within network</li>
<li>Ingress filtering: incoming packet with destination from within network</li>
<li>Doesn’t cover all spoofed traffic</li>
</ul></li>
</ul></li>
<li>Stateful inspection firewalls
<ul>
<li>Maintains state to identify packets grouped together</li>
<li>Can block unreasonable packet amounts</li>
<li>TCP inspection</li>
<li>Packets can be fragmented by IP layer and need to be reassembled</li>
</ul></li>
<li>Application proxies
<ul>
<li>Application connects to proxy which then sends it to server</li>
<li>Proxy can do sophisticated processes</li>
</ul></li>
</ul></li>
</ul>
<h2 id="honeypotshoneynets">Honeypots/Honeynets</h2>
<ul>
<li>Set up an unprotected, unused machine / network</li>
<li>Any activity on machine is suspicious</li>
<li>Helps <em>detect</em> if system is under attack, and type of attack</li>
<li>Diverts attacker energy away from attacking the new system</li>
<li>Honey pot = 1 machine, honey net = multiple machines</li>
<li>Types:
<ul>
<li>Low interaction
<ul>
<li>Daemon Service that emulates host</li>
<li>Easy to install and maintain</li>
<li>Can’t gather much information</li>
<li>Easy for attacker to detect</li>
</ul></li>
<li>High interaction
<ul>
<li>Deploy real hardware and software</li>
<li>Have stealth network switches or keyloggers for logging data</li>
<li>Complex to deploy</li>
<li>Can capture more information</li>
<li>Can capture unexpected behaviour by attacker</li>
</ul></li>
</ul></li>
</ul>
<h2 id="intrusion-detection-systems-idss">Intrusion detection systems (IDSs)</h2>
<ul>
<li>Protects from attackers inside network</li>
<li>Next line of defence after firewall</li>
<li>Monitors activity for suspicious events</li>
<li>Host-based or Network-based
<ul>
<li><strong>Host-based</strong>
<ul>
<li>Runs on the host</li>
<li>Lots of information from host</li>
<li>Misses information from other attacked hosts</li>
<li>Can be subverted from malware with root</li>
</ul></li>
<li><strong>Network-based</strong>
<ul>
<li>Runs on a dedicated node</li>
<li>Only sees information between the machines</li>
<li>Harder to subvert</li>
</ul></li>
</ul></li>
<li>Signature-based or Heuristic/anomaly-based
<ul>
<li><strong>Signature-based</strong>
<ul>
<li>Knows signatures of known attacks</li>
<li>Fails for new attacks or polymorphic worms</li>
<li>Can do statistical analysis
<ul>
<li>e.g more traffic than usual</li>
</ul></li>
</ul></li>
<li><strong>Heuristic/anomaly-based</strong>
<ul>
<li>Whitelist: model good behaviour and alert when activity changes</li>
<li>Blacklist: model bad behaviour and alert when activity matches</li>
<li>Improved by machine learning</li>
</ul></li>
</ul></li>
</ul>
<!-- - e.g Tripwire
    - Host-based, Anomaly-based
    - Detects file modifications
    - Fingerprint files and alerts when print changes
        - Look for abnormal behaviour -->
<ul>
<li>Other behaviour
<ul>
<li>Stealth
<ul>
<li>IDS systems should be stealthy so attacker does not know they’ve been discovered</li>
<li>Two network interfaces
<ol type="1">
<li>monitors traffic</li>
<li>administration and alerts, unpublished address</li>
</ol></li>
</ul></li>
<li>Responding to alarms
<ul>
<li>Have multiple levels of response
<ul>
<li>e.g Logging, calling human</li>
</ul></li>
<li>Response for false positives</li>
</ul></li>
<li>Base rate fallacy</li>
</ul></li>
</ul>
<h1 id="internet-application-security-and-privacy">Internet Application Security and Privacy</h1>
<h2 id="message-threats">Message Threats</h2>
<ul>
<li>Interception: packet sniffing</li>
<li>Interruption: man-in-the-middle attack</li>
<li>Modification: integrity attack</li>
<li>Fabrication: impersonating other users
<ul>
<li>Authenticity</li>
</ul></li>
</ul>
<h2 id="cryptography">Cryptography</h2>
<ul>
<li>Art/science of keeping messages secure
<ul>
<li>Kryptos = hidden</li>
<li>Graphem = writing</li>
</ul></li>
<li>Turn <strong>plaintext</strong> into <strong>ciphertext</strong></li>
<li>Allows us to send secure messages over an insecure medium</li>
<li>Ensures information transfer is not the weakest link (Principle of Easiest Penetration)</li>
<li>Cryptanalysis: art/science of secret message breaking</li>
<li>Cryptology: cryptography = cryptanalysis</li>
</ul>
<h3 id="basic-cryptographic-scheme">Basic Cryptographic Scheme</h3>
<ul>
<li>Plaintext (P) -&gt; [encryption/encoding/enciphering] -&gt; ciphertext (C) -&gt; [decryption, decoding, deciphering] -&gt; original plaintext (P)</li>
<li>Notation
<ul>
<li><code>M</code> plaintext</li>
<li><code>C</code> ciphertext</li>
<li><code>Enc(M) -&gt; C</code> encryption function</li>
<li><code>Dec(C) -&gt; M</code> decryption function</li>
</ul></li>
<li>Correctness: for all plaintext <code>M</code>, <code>Dec(Enc(M)) = M</code></li>
<li>Security: for all possible <code>C = Enc(M)</code>, it is <em>hard</em> to learn anything about <code>M</code></li>
<li>People:
<ul>
<li>Honest communicators: Alice, Bob, Carol, Dave</li>
<li>Trusted third party: Trent</li>
<li>Passive eavesdropper: Eve
<ul>
<li>Listens to any transmitted messages</li>
</ul></li>
<li>Active man-in-the-middle: Mallory
<ul>
<li>Listens, modifies, inserts or deletes transmitted messages</li>
</ul></li>
</ul></li>
</ul>
<h3 id="cryptography-components">Cryptography Components</h3>
<ul>
<li>Confidentiality: prevent Eve from <em>reading</em> Alice’s messages</li>
<li>Integrity: Prevent Mallory from <em>modifying</em> Alice’s messages without being detected</li>
<li>Authenticity: Prevent Mallory from <em>impersonating</em> Alice</li>
</ul>
<h3 id="kerckhoffs-principle">Kerckhoff’s Principle</h3>
<ul>
<li>A cryptosystem should be secure even if everything about the system, except the key, is public knowledge.
<ul>
<li>All crypto algorithms must be public</li>
<li>No security by obscurity</li>
<li>Keys are kept secret</li>
</ul></li>
<li>Implementation:
<ul>
<li>Have a large class of encryption methods (ideally equally strong) that is public information</li>
<li>Use a secret key to specify which one to use</li>
<li>Implication: system at most as secure as the number of keys</li>
</ul></li>
</ul>
<h3 id="strong-crytosystem">Strong crytosystem:</h3>
<ul>
<li>Has a large keyspace</li>
<li>Produces ciphertext that appears random to statistical tests</li>
<li>Resists known attacks</li>
<li>The attacker can have knowledge of:
<ul>
<li>The algorithm</li>
<li>Part of the plaintext</li>
<li>A number of corresponding plaintext/ciphertext pairs</li>
<li>Access to an encryption or decryption oracle</li>
</ul></li>
</ul>
<h2 id="types-of-cryptosystems">Types of cryptosystems</h2>
<ul>
<li>Secret Key (Symmetric)
<ul>
<li>Stream ciphers</li>
<li>Block ciphers</li>
</ul></li>
<li>Public Key (Asymmetric)</li>
</ul>
<h3 id="secret-key-encryption">Secret Key Encryption</h3>
<ul>
<li>Encryption key and decryption key are the same</li>
<li>e.g One-Time Pad
<ul>
<li>Perfectly secure</li>
<li>Key is a truly random bitstring with the same length as the message</li>
<li>XOR the message with the key or encryption and decryption</li>
<li>Difficult to use correctly
<ul>
<li>Key must be truly random</li>
<li>Key can only be used once
<ul>
<li>Otherwise you can XOR the result messages and a plaintext to get the other plaintext
<ul>
<li><code>C_1 = P_1 XOR K</code></li>
<li><code>C_2 = P_2 XOR K</code></li>
<li><code>C_1 XOR C_2 = P_1 XOR P_2</code></li>
<li><code>P_2 = C_1 XOR C_2 XOR P_1</code></li>
</ul></li>
</ul></li>
<li>Hard to share this key</li>
</ul></li>
</ul></li>
<li>Computational secure
<ul>
<li>Most cryptosystems only have ‘computational’ security</li>
<li>Can be broken with enough work
<ul>
<li>Claude Shannon: Amount of work should correspond with needed degree of security</li>
<li>Worst case Eve tries every key
<ul>
<li>Unless there are shortcuts</li>
</ul></li>
<li>A computer can try about 17 million keys per second</li>
</ul></li>
</ul></li>
<li>e.g <em>40-bit crypto</em>
<ul>
<li>Key size of 40 bits = 5 bytes</li>
<li><code>2^40</code> possible keys</li>
<li>Low level of security
<ul>
<li>Computer: 18 hours, lab: 11 minutes, BOINC: 5 ms</li>
</ul></li>
</ul></li>
<li>e.g <em>56-bit crypto</em>
<ul>
<li>DES standard</li>
<li>Computer: 134 years, lab: 16 months, BOINC: 5 minutes</li>
</ul></li>
<li>e.g <em>128-bit crypto</em>
<ul>
<li>Modern standard</li>
<li>One computer: 635 thousand million million million years</li>
<li>One lab: 6 thousand million million million years</li>
<li>BOINC: 49 thousand million million years</li>
<li>Actually faster because computers will get more powerful by Moore’s Law</li>
</ul></li>
</ul>
<h4 id="stream-ciphers">Stream Ciphers</h4>
<ul>
<li>Use a pseudorandom keystream with the One-Time Pad</li>
<li>Cipertext = (1 char of plaintext) XOR (1 char of keystream)</li>
<li>e.g RC4 (deprecated)</li>
<li>Usage:
<ul>
<li>Very fast</li>
<li>Hard to use correctly
<ul>
<li>What if the same key was used for two different messages?</li>
</ul></li>
</ul></li>
</ul>
<h4 id="block-ciphers">Block Ciphers</h4>
<ul>
<li>Operate on 1 block of message instead of one bit</li>
<li>Usually 64 bits or 128 bits long</li>
<li>e.g AES (today’s standard)</li>
<li>Mode of operation determines what happens when text is larger than one block
<ul>
<li>Electronic Code Book (ECB)
<ul>
<li>Encrypt each successive block separately</li>
<li>Patterns in the plaintext will cause patterns in the ciphertext</li>
</ul></li>
<li>Cipher Block Chaining, Counter, Galois Counter
<ul>
<li>Will not expose patterns in plaintext</li>
<li>Requires an initial value</li>
</ul></li>
</ul></li>
</ul>
<h4 id="key-exchange">Key Exchange</h4>
<ul>
<li>The two parties need to exchange the secret key somehow
<ul>
<li>Meet in person (difficult)</li>
<li>AES (Advanced Encryption Standard)</li>
</ul></li>
</ul>
<h3 id="public-key-cryptography">Public Key Cryptography</h3>
<ul>
<li>Allows Alice to send a secret message to Bob <em>without</em> a prearranged shared secret</li>
<li>Encryption key and decryption key are different</li>
<li>e.g RSA, ECC</li>
<li>Bob publishes his public encryption key which others use to encrypt his messages</li>
<li>Bob uses his private decryption key to decrypt the message</li>
<li>Problems
<ul>
<li>Public keys need to be larger to have the same computational security as symmetric encryption</li>
<li>Public key cryptography is slower</li>
</ul></li>
</ul>
<h4 id="hybrid-cryptography">Hybrid cryptography</h4>
<ol type="1">
<li>Pick a random 128-bit key <code>K</code></li>
<li>Encrypt the large message with <code>K</code> using symmetric encryption</li>
<li>Encrypt the key <code>K</code> using a public-key cryptosystem</li>
<li>Send the encrypted message and key to Bob</li>
</ol>
<h2 id="integrity">Integrity</h2>
<ul>
<li>Prevent Mallory from modifying the message in transit</li>
<li>Detecting message changes by including a checksum
<ul>
<li>Checksum must be a <em>cryptographic checksum</em></li>
<li>Need to be able to send the message digest in a secure manner</li>
</ul></li>
</ul>
<h3 id="cryptographic-hash-functions">Cryptographic Hash Functions</h3>
<ul>
<li>A <strong>hash function</strong> <code>h</code> takes an arbitrary length string <code>x</code> and computes a fixed length message digest <code>y = h(x)</code>
<ul>
<li>e.g MD5, SHA-1, SHA-2, SHA-3</li>
</ul></li>
<li>Properties
<ol type="1">
<li>Preimage-resistance
<ul>
<li>Given <code>y</code>, hard to find <code>x</code> such that <code>h(x) = y</code></li>
</ul></li>
<li>Second preimage-resistance
<ul>
<li>Given <code>x</code>, hard to find <code>x&#39; != x</code> such that <code>h(x) = h(x&#39;)</code></li>
</ul></li>
<li>Collision-resistance
<ul>
<li>Hard to find two distinct values <code>x</code>, <code>x&#39;</code> such that <code>h(x) = h(x&#39;)</code></li>
<li>Collisions are easier to find than preimages (birthday paradox)</li>
</ul></li>
</ol></li>
</ul>
<h2 id="authentication">Authentication</h2>
<ul>
<li>Have a large class of hash functions</li>
<li>Shared secret key used to pick the ‘correct’ hash function</li>
<li>Only those with the secret key can generate and check the hash digest (‘<em>tag</em>’)</li>
<li><strong>Message Authentication Codes (MAC)</strong>: keyed hash function
<ul>
<li>e.g SHA-1-HMAC, SHA-256-HMAC, CBC-MAC</li>
</ul></li>
</ul>
<h3 id="confidentiality-and-integrity">Confidentiality and Integrity</h3>
<ul>
<li>Combine cipher and MAC</li>
<li><em>Encrypt-then-MAC</em>
<ul>
<li>Not MAC-then-Encrypt or Encrypt-and-MAC</li>
</ul></li>
</ul>
<h3 id="repudiation">Repudiation</h3>
<ul>
<li>e.g
<ol type="1">
<li>Alice and Bob share a MAC key K</li>
<li>Bob receives a message M, and a valid tag T computed using key K</li>
</ol></li>
<li>Bob is sure that Alice sent message M, and it hasn’t been modified</li>
<li>If Bob showed Carol message M and tag T, she wouldn’t be sure it’s from Alice
<ul>
<li>Alice can claim Bob made up message M, and calculated tag T</li>
</ul></li>
<li><strong>Repudiation</strong>: when Alice can deny the authenticity of her signature</li>
<li>Repudiable interactions: private conversations</li>
<li>Non-repudiable interactions: electronic commerce</li>
</ul>
<h4 id="digital-signatures">Digital Signatures</h4>
<ul>
<li>Used for non-repudiation</li>
<li>If Bob receives a message with Alice’s <em>digital signature</em>, we know that
<ul>
<li>Alice sent the message</li>
<li>Message has not been altered</li>
<li>Bob can prove this to a third party</li>
</ul></li>
<li>Making a digital signature
<ul>
<li>Separate keys for encryption and decryption
<ul>
<li>Public <strong>verification key</strong></li>
<li>Private <strong>signature key</strong></li>
</ul></li>
<li>Alice signs with private <em>signature key</em></li>
<li>Verification: Bob verifies using public <em>verification key</em></li>
</ul></li>
</ul>
<h4 id="hybrid-signatures">Hybrid Signatures</h4>
<ul>
<li>Signing large message is slow</li>
<li>Solution: hybrid signatures
<ul>
<li>Alice sends
<ul>
<li>the unsigned message, and</li>
<li>a signature on a <em>hash</em> of the message</li>
</ul></li>
<li>Easier to sign and verify the message hash since it is smaller</li>
</ul></li>
</ul>
<h4 id="combining-public-key-encryption-and-digital-signatures">Combining Public-key encryption and digital signatures</h4>
<ul>
<li>Need both to have authenticity and confidentiality
<ol start="0" type="1">
<li>Alice and Bob each have different (encryption, decryption) and (signature, verification) key pairs</li>
<li>Alice uses Bob’s encryption key to encrypt a message</li>
<li>Alice uses Alice’s signature key to sign the ciphertext</li>
<li>Bob uses Alice’s verification key to check the signature</li>
<li>Bob uses Bob’s decryption key to decrypt the ciphertext</li>
</ol></li>
<li>(signature, verification) key pair is long-lived (for forward secrecy)</li>
<li>(encryption, decryption) key pair is short-lived
<ul>
<li>Use signing key to sign the new encryption key</li>
</ul></li>
<li>Note: if Alice and Bob’s communication is interactive, they can use secret-key encryption instead of (encryption, decryption) key pairs
<ul>
<li>e.g TLS, SSH</li>
<li>TODO: why?</li>
</ul></li>
</ul>
<h3 id="key-management">Key Management</h3>
<ul>
<li>How does Bob find Alice’s verification key?</li>
<li><strong>Manual keying</strong>: personally know it (e.g SSH)</li>
<li><strong>Web of trust</strong>: trust a friend to tell him (e.g PGP)</li>
<li><strong>Certificate Authorities (CAs)</strong>: trust a third party (e.g TLS, SSL)</li>
</ul>
<h4 id="certificate-authorities-ca">Certificate Authorities (CA)</h4>
<ul>
<li>Trusted third party that keeps track of people/organization’s verification keys</li>
<li>Alice sends the signed verification key and signed personal information to the CA</li>
<li>CA verifies that the information is correct</li>
<li>CA generates a certificate with Alice’s information and verification key signed with CA’s signature key</li>
<li>Assume everyone has a copy of the CA’s verification key</li>
<li>Can have multiple levels of CA’s, where higher levels issue certificates for lower levels
<ul>
<li>e.g Public-key infrastructure (PKI)</li>
</ul></li>
<li>Only need the verification key of root CA to verify the certificate chain</li>
</ul>
<h2 id="security-controls-using-cryptography">Security controls using cryptography</h2>
<ul>
<li>How do you make secrets available to legitimate users but not adversaries?</li>
<li>e.g If the web browser can decrypt the password file, an adversary who accesses the web browser can as well</li>
</ul>
<h3 id="os-security">OS Security</h3>
<ul>
<li>Secret-key cryptography is problematic</li>
<li>Public-key cryptography is fine</li>
<li>You can only do encryption and signature verification</li>
<li>e.g Only install signed apps (Android)</li>
<li>e.g Only execute signed programs (iOS)</li>
</ul>
<h3 id="encrypted-code">Encrypted Code</h3>
<ul>
<li>Processor that only executes encrypted code</li>
<li>Processor-dependent decryption key used to decrypt instructions before executing</li>
<li>Malware needs the processor’s key to spread</li>
<li>Downsides: Need to encrypt program for each processor</li>
</ul>
<h3 id="encrypted-data">Encrypted Data</h3>
<ul>
<li>Harddrive encryption protects data on a stolen laptop</li>
<li>Does not protect data against legitimate users of the laptop
<ul>
<li>e.g User installed malware</li>
<li>e.g Extracting the decryption key from laptop memory</li>
</ul></li>
</ul>
<h3 id="os-authentication">OS Authentication</h3>
<ul>
<li>Authentication uses cryptography
<ul>
<li>e.g Salted hashes</li>
</ul></li>
<li>Also hardware tokens
<ul>
<li>e.g Yubikey</li>
</ul></li>
</ul>
<h2 id="cryptography-in-network-security">Cryptography in network security</h2>
<ul>
<li>Primary use of cryptography</li>
<li>Entities on the network are not trustworthy</li>
<li>Each layer of the network uses cryptography
<ul>
<li>Link: WEP, WPA, WPA2</li>
<li>Network: VPN, IPsec</li>
<li>Transport: TLS / SSL, Tor</li>
<li>Application: ssh, PGP, Mixminion, OTR</li>
</ul></li>
</ul>
<h3 id="link-layer-security-controls">Link-layer Security Controls</h3>
<ul>
<li>Used to protect <em>local area networks</em></li>
</ul>
<h4 id="wep-wired-equivalent-privacy">WEP (Wired Equivalent Privacy)</h4>
<ul>
<li>3 goals:
<ul>
<li>confidentiality (protect contents of traffic),</li>
<li>access control (prevent others from using your wireless infrastructure),</li>
<li>data integrity</li>
<li><em>Does not enforce any of these</em></li>
</ul></li>
<li>Description
<ul>
<li>Sender and receiver share a 40-bit or 104-bit secret <code>k</code></li>
<li>To transmit message <code>M</code>:
<ol type="1">
<li>Compute checksum <code>c(M)</code></li>
<li>Pick a random number <code>v</code> and generate a keystream <code>RC4(v,k)</code></li>
<li><code>XOR(M, c(M))</code> with keystream to produce ciphertext <code>C</code></li>
<li>Transmit <code>v</code> and ciphertext over wireless link</li>
</ol></li>
<li>Receiver:
<ol type="1">
<li>Use <code>v</code> and <code>k</code> to generate keystream <code>RC4(v,k)</code></li>
<li><code>XOR(C, RC4(v,k))</code> to get <code>M&#39;, c&#39;</code></li>
<li>Check if <code>c&#39; = c(M&#39;)</code></li>
<li>If so, accept <code>M&#39;</code> as the message</li>
</ol></li>
</ul></li>
<li>Problems:
<ol type="1">
<li><code>v</code> is only 24 bits long</li>
<li>Checksum is <code>CRC-32</code> which is <em>linear</em> (insecure when used with a stream cipher)</li>
<li>Plaintext/ciphertext pair is given for free</li>
<li>Attacker can execute the authentication protocol with the Plaintext/ciphertext pair</li>
</ol></li>
<li>TODO: figure out WEP details (5-93)</li>
</ul>
<h3 id="network-layer-security">Network-layer Security</h3>
<ul>
<li>We need end-to-end security across networks</li>
<li>Send individual IP packets securely from one network to another</li>
</ul>
<h4 id="vpn-virtual-private-network">VPN (Virtual Private Network)</h4>
<ul>
<li>Connects 2+ networks that are physically isolated and make them appear to be a single network
<ul>
<li>Or connect a single remote host to a network</li>
</ul></li>
<li>Goal: Adversaries between the networks can’t read/modify traffic in the VPN
<ul>
<li>DoS and traffic analysis still possible</li>
</ul></li>
<li>Setup:
<ul>
<li>A host on each side is the <strong>VPN gateway</strong></li>
<li>Traffic is sent through the local VPN gateway</li>
<li>Local VPN gateway uses cryptography to send traffic to the remote VPN gateway (usually <em>tunnelling</em>)</li>
<li>Remote VPN gateway decrypts messages and sends them to the destination</li>
</ul></li>
</ul>
<h4 id="tunnelling">Tunnelling</h4>
<ul>
<li>Sending of messages of one protocol as the payload of messages of another protocol, out of the usual protocol nesting sequence
<ul>
<li>e.g IP-over-TCP, IP-over-IP, PPP-over-DNS</li>
<li>e.g NOT TCP-over-IP (since it is the typical sequence)</li>
</ul></li>
</ul>
<h4 id="ipsec">IPsec</h4>
<ul>
<li>Two modes
<ul>
<li><em>Transport</em> mode
<ul>
<li>Used to connect a single laptop to a home network</li>
<li>Only contents of original IP packet are encrypted + authenticated</li>
</ul></li>
<li><em>Tunnel</em> mode
<ul>
<li>Connecting two networks</li>
<li>Contents and header of of original IP packet are encrypted and authenticated</li>
<li>Encrypted package is placed in a new IP packet destined for the remote VPN gateway</li>
</ul></li>
</ul></li>
</ul>
<h4 id="other-vpns">Other VPNs</h4>
<ul>
<li>PPTP
<ul>
<li>Microsoft</li>
<li>Has design flaws</li>
</ul></li>
<li>ssh
<ul>
<li>Tunnel PPP over ssh
<ul>
<li>IP-over-PPP-over-ssh-over-TCP-over-IP</li>
<li>Efficiency concerns</li>
<li>Simple to set up on Unix</li>
</ul></li>
<li>OpenSSH
<ul>
<li>IP-over-SSH</li>
</ul></li>
</ul></li>
</ul>
<h3 id="transport-layer-security">Transport-layer Security</h3>
<ul>
<li>Transform arbitrary TCP connections to add security</li>
<li>Security: TLS</li>
<li>Privacy: Tor</li>
</ul>
<h4 id="privacy-enhancing-technology">Privacy Enhancing Technology</h4>
<ul>
<li>Technologies that enhance user control and remove personal identifiers</li>
<li>May want to hide message metadata, or existence of messages
<ul>
<li>e.g Message target</li>
</ul></li>
<li>Categories
<ul>
<li>Encryption tools (e.g SSL)</li>
<li>Policy tools (e.g P3P, TRUSTe)</li>
<li>Filtering tools (e.g Spyware)</li>
<li>Anonymity tools (e.g Anonymizer, iPrivacy)</li>
</ul></li>
</ul>
<h4 id="nymity-levels">Nymity levels</h4>
<ul>
<li><strong>Verinymity</strong>
<ul>
<li>Government ID, SIN, credit card #, address</li>
</ul></li>
<li><strong>Persistent pseudonymity</strong>
<ul>
<li>Pen name (”Noms de plume”), many blogs</li>
</ul></li>
<li><strong>Linkable anonymity</strong>
<ul>
<li>Prepaid phone cards, loyalty cards</li>
</ul></li>
<li><strong>Unlinkable anonymity</strong>
<ul>
<li>Cash payments</li>
</ul></li>
<li>Nymity Slider:
<ul>
<li>Easy to modify system to have higher nymity levels, harder to have lower level</li>
</ul></li>
</ul>
<h4 id="tls-ssl">TLS / SSL</h4>
<ul>
<li>Transport Layer Security</li>
<li>Protocol to protect any TCP-based connection
<ul>
<li>HTTP + SSL = HTTPS</li>
</ul></li>
<li>How it works
<ul>
<li>Exists between the application and transport layers</li>
<li>Two protocol layers
<ul>
<li>Handshake layer
<ul>
<li>Responsible for initial handshake in SSL/TLS</li>
</ul>
<ol type="1">
<li>Client connects to server, indicates it wants to use TLS, and the supported <strong>ciphersuites</strong></li>
<li>Server sends its certificate (host name, verification key, admin information, CA signature) and chooses a <em>ciphersuite</em></li>
<li>Client validates server certificate</li>
<li>Client and server run key agreement protocol to establish symmetric encryption keys and MAC algorithms</li>
<li>Communicate proceeds using chosen symmetric encryption and MAC algorithms</li>
</ol></li>
<li>Record layer
<ol type="1">
<li>Gets data from application</li>
<li>encrypts data</li>
<li>(optionally) compresses or decompresses data</li>
<li>fragments data into appropriate size</li>
<li>send to transport layer</li>
</ol></li>
</ul></li>
</ul></li>
<li>Security Properties
<ul>
<li>Server authentication</li>
<li>Message integrity</li>
<li>Message confidentiality</li>
<li>Client authentication</li>
</ul></li>
<li>Most successful <em>Privacy Enhancing Technology</em>
<ul>
<li>Comes with browser</li>
<li>Works without user configuration</li>
</ul></li>
</ul>
<h4 id="tor">Tor</h4>
<ul>
<li>Privacy enhancing technology at transport layer</li>
<li>TCP connections normally reveal your IP address</li>
<li>How it works
<ul>
<li>7000 Tor nodes (<em>Onion Routers</em>) scattered around Internet</li>
<li>Communication:
<ul>
<li>Alice establishes encrypted communication channel with a Tor node <code>OR_1</code>
<ul>
<li><code>OR1</code> knows Alice is using Tor and the next node is <code>OR2</code></li>
</ul></li>
<li>Alice tells <code>OR_1</code> to establish a new encrypted communication channel with <code>OR_2</code> (tunnelled within <code>OR_1</code> connection)</li>
<li>Alice tells <code>OR_2</code> to establish a new encrypted communication channel with <code>OR_3</code> (tunnelled within <code>OR_2</code> connection)</li>
<li>… so on or as many desired steps</li>
<li>Alice tells the last node to connect to the website
<ul>
<li><code>OR3</code> knows a Tor user is connecting to a particular website</li>
</ul></li>
</ul></li>
<li>Alice has secret keys with each OR</li>
<li>To send message M, she sends <code>E_k1(E_k2(E_k3(M)))</code></li>
<li>To receive response R, each OR encrypts it and Alice receives <code>E_k1(E_k2(E_k3(R)))</code></li>
</ul></li>
<li>Provides short-term <em>linkably</em>, but long-term <em>unlinkably</em> <em>anonymity</em> in TCP connections</li>
</ul>
<h3 id="application-layer">Application-Layer</h3>
<h4 id="remote-login">Remote Login</h4>
<ul>
<li>Usage
<ol type="1">
<li>Client connects to server</li>
<li>Server sends verification key that client verifies</li>
<li>Client and server run key agreement protocol
<ul>
<li>Use encryption and MAC after this</li>
</ul></li>
<li>Client authenticates server</li>
<li>Server accepts authentication</li>
</ol></li>
<li>Two authentication methods
<ul>
<li>Send a password
<ul>
<li>Server needs a hash of your password</li>
</ul></li>
<li>Sign a random challenge with private signature key
<ul>
<li>Server needs your public verification key</li>
</ul></li>
</ul></li>
</ul>
<h4 id="email">Email</h4>
<ul>
<li><em>Remailers</em> allow email sending without revealing own email address
<ul>
<li>Not for conversations</li>
</ul></li>
<li>Type 0:
<ul>
<li>e.g <code>anon.penet.fi</code></li>
<li>Forwards and receives email for you</li>
<li>Remailer service keeps table to id to email address</li>
<li>Pseudonymity</li>
</ul></li>
<li>Type I:
<ul>
<li>Cypherpunk</li>
<li>Send messages through a chain of several remailers</li>
<li>No pseudonymity, so replies not possible
<ul>
<li>Fix: ‘nym servers’ that map pseudonyms to reply blocks containing a nested encryption chain of Type I remailers</li>
</ul></li>
</ul></li>
<li>Type II
<ul>
<li>Mixmaster</li>
<li>Constant-length messages</li>
<li>Protection against replay attacks</li>
<li>Requires special email client to construct message fragments</li>
</ul></li>
<li>Type III
<ul>
<li>Mixminion</li>
<li>Native support for pseudonymity (instead of Type I reply blocks)</li>
<li>Improved protection against replay and key compromise attacks</li>
</ul></li>
</ul>
<h5 id="pretty-good-privacy-pgp">Pretty Good Privacy (PGP)</h5>
<ul>
<li>Protects contents of email messages</li>
<li>Use public-key cryptography to provide
<ul>
<li>encrypted email messages (hybrid encryption)</li>
<li>digital signatures on email messages (hash-then-sign)</li>
</ul></li>
<li>Functions
<ul>
<li>Creates 4 keys: encryption, decryption, signature, verification</li>
<li>Message encryption (using their encryption key)</li>
<li>Message decryption using your decryption key</li>
<li>Message signature using your signature key</li>
<li>Signature verification using their verification key</li>
<li>Sign other keys using your signature key</li>
</ul></li>
<li>Key verification
<ul>
<li><strong>Fingerprints</strong>: Keys have a crytographic hash used to verify keys</li>
<li><strong>Key signatures</strong>: Alice can sign Bob’s key to verify it for Carol who trusts Alice
<ul>
<li>Creates a <strong>Web of Trust</strong></li>
</ul></li>
</ul></li>
<li>What if attackers got hold of Bob’s key material
<ul>
<li>This leaks the contents and participants of Bob’s past conversations</li>
<li>Includes signatures of who said what</li>
<li>Goes against forward secrecy and deniable authentication</li>
</ul></li>
<li>Perfect forward secrecy
<ul>
<li>Future key compromises should not reveal past communication</li>
<li>Use <em>session keys</em> instead that are securely erased after use</li>
<li>Diffie-Hellman key exchange protocol
<ul>
<li>Alice and Bob agree on prime <code>p</code> and generator <code>g</code></li>
<li>Alice chooses secret random number <code>a</code></li>
<li>Alice sends <code>A = g^a mod p</code></li>
<li>Bob chooses secret random number <code>b</code></li>
<li>Bob sends <code>B = g^b mod p</code></li>
<li>The secret key is <code>K = B^a mod p = A^b mod p</code></li>
</ul></li>
</ul></li>
<li>Deniable Authenication
<ul>
<li>Good for contracts, but not for private conversations</li>
<li>Use <em>Message Authentication Codes</em>
<ul>
<li>Anyone who can verify can also forge a message</li>
</ul></li>
</ul></li>
</ul>
<h4 id="instant-messaging">Instant Messaging</h4>
<ul>
<li>Off-the-Record Messaging (OTR)
<ul>
<li>Allows private conversations over instant messaging</li>
<li>Provides confidentiality, authentication, perfect forward secrecy and deniability</li>
<li>e.g Signal (used by WhasApp, FB Messenger, Google Allo)</li>
</ul></li>
</ul>
<h1 id="database-security-and-privacy">Database Security and Privacy</h1>
<h2 id="introduction-to-databases">Introduction to databases</h2>
<ul>
<li><strong>Relational Database</strong>: structured, queryable collection of <em>records</em></li>
<li><strong>Records</strong>: data consisting of fields (<strong>elements</strong>)</li>
<li><strong>Schema</strong>: structure set by database administrator</li>
<li><strong>DBMS</strong> provides support for queries and management
<ul>
<li>Most popular DBMS are based on the <em>relational model</em></li>
</ul></li>
<li>Advantages
<ul>
<li>Shared access</li>
<li>Controlled access</li>
<li>Minimal redundancy</li>
<li>Data consistency</li>
<li>Data integrity</li>
</ul></li>
</ul>
<h3 id="relations">Relations</h3>
<ul>
<li>Records are stored in one or multiple tables (<em>relations</em>)
<ul>
<li>Table has named columns (<em>attributes</em>) and rows (<em>tuples</em>)</li>
<li>Tables can have relationships between them</li>
</ul></li>
</ul>
<h3 id="queries">Queries</h3>
<ul>
<li>Most popular query language is SQL</li>
<li><strong>Subschema</strong>: query result</li>
</ul>
<h2 id="security-requirements">Security requirements</h2>
<ul>
<li>Physical database integrity</li>
<li>Logical database integrity</li>
<li>Element integrity</li>
<li>Referential integrity</li>
<li>Auditability</li>
<li>Access control</li>
<li>User authentication</li>
<li>Availability</li>
</ul>
<h3 id="database-integrity">Database Integrity</h3>
<ul>
<li>Logical integrity: protect against database corruption
<ul>
<li>Only allow authorized individuals to perform updates</li>
</ul></li>
<li>Physical integrity: recover from physical problems
<ul>
<li>Perform periodic backups</li>
<li>Keep log of transactions to replay transactions</li>
</ul></li>
</ul>
<h3 id="element-integrity">Element integrity</h3>
<ul>
<li>Ensure correctness/accuracy of database elements</li>
<li><em>Access control</em> to limit who can update elements</li>
<li><em>Element check</em> to validate correctness
<ul>
<li>Prevents user mistakes</li>
<li>e.g Datatype</li>
<li>e.g Only one employee can be president</li>
<li>Enforced with <em>triggers</em></li>
</ul></li>
<li><em>Change log / Shadow fields</em>: to undo erroneous changes
<ul>
<li>In case previous checks fail</li>
<li>Requires additional DB space</li>
</ul></li>
<li><em>Error detection codes</em> to protect against OS / hard disk problems</li>
</ul>
<h3 id="integrity-1">Integrity</h3>
<ul>
<li>Two-Phase Update
<ul>
<li>For a set of operations, either all or none of them should be performed
<ul>
<li>Causes integrity problems if only some are performed</li>
</ul></li>
<li>Phase 1: gather information required for changes</li>
<li>Phase 2: Make changes permanent</li>
</ul></li>
<li>Concurrency Control
<ul>
<li>Concurrent modifications lead to integrity violations</li>
<li>Operations need to be <strong>atomic</strong></li>
</ul></li>
</ul>
<h3 id="referential-integrity">Referential Integrity</h3>
<ul>
<li>Every table has a primary key (minimal attribute set) that uniquely identifies each tuple</li>
<li>Table can have foreign keys</li>
<li><em>Referential integrity</em> ensures there are no dangling foreign keys</li>
</ul>
<h3 id="auditability">Auditability</h3>
<ul>
<li>Keep an audit log of all database accesses (read and write)</li>
<li>Allows identification of users who accessed forbidden data, instead of relying on access control</li>
<li>Combination of allowed accesses can result in disclosure</li>
</ul>
<h3 id="access-control-1">Access control</h3>
<ul>
<li>Problems
<ul>
<li>Many operation types (SELECT, INSERT, UPDATE, CREATE, DROP, etc.)</li>
<li>Need to control access at relation, record or element level</li>
<li>Relationships between objects allow indirect information access
<ul>
<li><em>Inference problem</em></li>
</ul></li>
<li>Efficiency problem with many records</li>
<li>Need to consider past queries</li>
<li>Need to consider types of queries
<ul>
<li>e.g <code>SELECT last name, salary FROM staff</code> vs <code>SELECT last name FROM staff</code></li>
</ul></li>
</ul></li>
</ul>
<h3 id="user-authentication-1">User authentication</h3>
<ul>
<li>Done by database</li>
<li>Can do additional checks (e.g time of day)</li>
</ul>
<h3 id="availability">Availability</h3>
<ul>
<li>Availability problems when multiple users want to access at the same time</li>
<li>e.g Update operations</li>
</ul>
<h2 id="data-disclosure-and-inference">Data disclosure and inference</h2>
<h3 id="types-of-data-disclosure">Types of data disclosure</h3>
<ul>
<li><strong>Exact data</strong></li>
<li><strong>Metadata</strong>
<ul>
<li>Bounds: indicate a value is between two values
<ul>
<li>Attacker can binary search</li>
</ul></li>
<li>Negative result: disclose that <code>z</code> is NOT <code>y</code></li>
<li>Existence: disclose that data exists</li>
<li>Probable value: probability a certain element has a certain value</li>
</ul></li>
</ul>
<h3 id="security-vs-precision">Security vs Precision</h3>
<ul>
<li>Precision: reveal as much non-sensitive data as possible
<ul>
<li>Aggregated result should reveal as much non-sensitive data as possible</li>
<li>Attacker can use disclosed data to infer hidden data</li>
</ul></li>
<li>Security: reveal only non-sensitive data
<ul>
<li>Reject any query that mentions a sensitive field</li>
<li>Aggregated: Reject queries that access sensitive data even if aggregated result is non-sensitive</li>
<li>May reject reasonable, non-disclosing queries</li>
</ul></li>
<li>Want perfect confidentiality with maximum precision</li>
</ul>
<h3 id="data-inference">Data Inference</h3>
<ul>
<li>Deriving sensitive data from non-sensitive data</li>
<li>Direct attack
<ul>
<li>Query that directly yields sensitive data</li>
<li>Possibly obfuscated</li>
<li>e.g <code>SELECT SUM(salary) FROM staff WHERE lastname = ’Adams’ OR (sex = ’M’ AND sex = ’F’)</code></li>
<li>Control: <strong>“n items over k percent” rule</strong>
<ul>
<li>Data should be withheld if <code>n</code> items represent over <code>k</code>% of the result</li>
<li>Don’t reveal results where a small number of records make up a large proportion of the category</li>
</ul></li>
</ul></li>
<li>Indirect attack
<ul>
<li>Statistical Inference attack
<ul>
<li>Infer sensitive data from statistical results</li>
<li><code>SUM</code>: leaks data if only one record, or if attacker can control set of covered records</li>
<li><code>COUNT</code>: useful for SUM attack</li>
<li><code>MEAN</code>: sum = count * mean</li>
<li><code>MEDIAN</code>: intersecting medians can leak data</li>
</ul></li>
<li>Tracker attack</li>
</ul></li>
</ul>
<h4 id="tracker-attack">Tracker Attack</h4>
<ul>
<li>Variables:
<ul>
<li>N: number of records in a database</li>
<li>q(): result of a query (e.g COUNT, SUM)</li>
<li>S: set of all records</li>
</ul></li>
<li>Situation: DBMS refuses to answer query C if it matches fewer than <code>k</code> or more than <code>N - k</code> (but not all <code>N</code>) records</li>
<li>A tracker <code>T</code> is a query whose result matches between <code>2k</code> and <code>N - 2k</code> records
<ul>
<li>DBMS will answer query T and query <em>not</em> T</li>
</ul></li>
<li><strong>q(C) = q(C or T) + q(C or !T) - q(S)</strong>
<ul>
<li>Use if q(C) matches less than k records</li>
</ul></li>
<li><strong>q(C) = 2q(S) - q(!C or T) - q(!C or !T)</strong>
<ul>
<li>Use if q(C) matches more than N-k records</li>
</ul></li>
</ul>
<h4 id="control-for-statistical-inference-attack">Control for Statistical Inference Attack</h4>
<ul>
<li>Controlling query is difficult</li>
<li>Control data item
<ul>
<li><strong>Suppression</strong> of sensitive data from result
<ul>
<li>Sensitive data values are not provided</li>
<li>Reject queries without response</li>
</ul></li>
<li><strong>Concealing</strong> of sensitive data
<ul>
<li>Give answer close to, but equal to data value</li>
</ul></li>
<li><em>n-item k-percent rule</em>
<ul>
<li>If there is a subset of <code>n</code> records responsible for over <code>k</code> percent of result, omit the <code>n</code> records</li>
<li>Omission leaks information</li>
</ul></li>
<li>Combined results
<ul>
<li>Report set or range of possible values</li>
</ul></li>
<li>Random sample
<ul>
<li>Compute result on random sample of database</li>
<li>Equivalent queries need to use the same sample</li>
</ul></li>
<li>Random data perturbation
<ul>
<li>Add/subtract small random error from each value</li>
<li>Statistical properties will still be maintained</li>
</ul></li>
<li>Query analysis
<ul>
<li>Maintain history of user queries to observe possible inferences</li>
<li>Expensive</li>
<li>Fails for colluding users</li>
</ul></li>
</ul></li>
</ul>
<h3 id="differential-privacy">Differential Privacy</h3>
<ul>
<li>Maximize accuracy while minimizing privacy impact</li>
<li>Typically achieved by adding noise to query result before release</li>
<li>Response to query should not depend on individual’s existence in dataset</li>
<li>Query <code>K</code> has <strong>ε-differential privacy</strong> if
<ul>
<li>For all datasets DB and DB’, where DB and DB’ differ in at most 1 row</li>
<li><code>Pr[K(DB) in S] &lt;= e^ε * Pr[K(DB&#39;) in S]</code></li>
<li>“the probability that K(DB) has a particular output is at most e^ε × the probability that K(DB′) has this output”</li>
</ul></li>
</ul>
<h3 id="data-aggregation">Data Aggregation</h3>
<ul>
<li>Can build sensitive results from less sensitive inputs</li>
<li>Outside of DBMS and difficult to control</li>
<li>Similar to Data Mining</li>
</ul>
<h2 id="multilevel-security-databases">Multilevel security databases</h2>
<ul>
<li>Supports classification / compartmentalization of information according to confidentiality</li>
<li>Can be element level classification
<ul>
<li>e.g Salary only sensitive for some employees</li>
</ul></li>
<li>Each object has a sensitivity classification and optional set of compartments
<ul>
<li>Object = element, aggregate, column or row</li>
</ul></li>
</ul>
<h3 id="security-issues">Security Issues</h3>
<h4 id="integrity-2">Integrity</h4>
<ul>
<li>Need to enforce “No write down” (*-property)</li>
<li>Difficult to implement
<ul>
<li>Users doing write-ups are writing blind</li>
<li>Write-downs need to be sanitized</li>
<li>Trusted processes are able to do anything</li>
</ul></li>
<li>DBMS needs to answer queries, perform back-ups, etc.
<ul>
<li>DBMS needs to have all level read/write access</li>
</ul></li>
</ul>
<h4 id="confidentiality">Confidentiality</h4>
<ul>
<li>Different users at different levels may get different query results
<ul>
<li>Leads to redundancy</li>
</ul></li>
<li>Existence of a record can be confidential
<ul>
<li><strong>Polyinstantiation</strong>: have multiple records with the same primary key but different sensitivities</li>
<li>e.g Admin sees no record for “Bob” and creates one
<ul>
<li>However, “Bob” already has a record, but is secret</li>
<li>DBMS needs to allow Admin’s request to not leak information</li>
<li>Results in two “Bob” records</li>
</ul></li>
</ul></li>
</ul>
<h3 id="solutions">Solutions</h3>
<h4 id="partitioning">Partitioning</h4>
<ul>
<li>Have a separate database for each classification level</li>
<li>Pros:
<ul>
<li>Simple</li>
</ul></li>
<li>Cons:
<ul>
<li>Can lead to data redundancy in multiple databases</li>
<li>High-level user may need to combine low-level and high-level data</li>
</ul></li>
</ul>
<h4 id="encryption">Encryption</h4>
<ul>
<li>Encrypt data with key unique to its classification level</li>
<li>Cons
<ul>
<li>Need to choose encryption scheme carefully</li>
<li>Query processing becomes expensive (need to decrypt records)</li>
</ul></li>
</ul>
<h4 id="integrity-lock">Integrity Lock</h4>
<ul>
<li>Each data item consist of:
<ul>
<li>Actual data</li>
<li>Integrity level</li>
<li>Cryptographic signature / MAC covering (data, integrity level, attribute name, record number)</li>
</ul></li>
<li>Signature protects against attacks trying to modify the fields, or move the record
<ul>
<li>Does not protect against replay attacks</li>
</ul></li>
<li>A trusted procedure interfaces between the database and DBMS and handles access control and integrity locks
<ul>
<li>Untrusted databases can store data items and their integrity locks
<ul>
<li>Locks take a lot of space</li>
</ul></li>
<li>Trusted procedure handles access control and manages integrity locks
<ul>
<li>e.g Update integrity level or re-computing signature</li>
<li>Expensive operation</li>
</ul></li>
<li>If the sensitive database can be accessed by another way, then we need to encrypt the database as well
<ul>
<li>Expensive query processing</li>
</ul></li>
</ul></li>
</ul>
<h2 id="designs-of-secure-databases">Designs of secure databases</h2>
<h3 id="trusted-front-end">Trusted Front End</h3>
<ul>
<li>Front end authenticates user</li>
<li>Front end forwards user query to untrusted DBMS</li>
<li>Front end removes confidential data from DMBS result</li>
<li>Pro: allows usage of existing DBMS and databases</li>
<li>Con: inefficient since items returned by DBMS are being dropped</li>
</ul>
<h3 id="commutative-filters">Commutative Filters</h3>
<ul>
<li>Front end re-writes user query according to user’s classification
<ul>
<li>Remove confidential attributes</li>
<li>Add constraints expressing classsification</li>
</ul></li>
<li>Pro: Benefit from DBMS’s query processing capabilities</li>
<li>Con: Front end may still need to do post processing</li>
</ul>
<h3 id="distributed-federated-databases">Distributed / Federated Databases</h3>
<ul>
<li>Based on partitioning</li>
<li>Front end forwards user query only to databases that user has clearance for</li>
<li>Con: front end needs to combine results from multiple databases</li>
<li>Con: doesn’t scale to many classification labels</li>
</ul>
<h3 id="views">Views</h3>
<ul>
<li>Logical database representing a subset of another database</li>
<li>Elements in view correspond to an element in the underlying database, or an aggregation</li>
<li>Access control:
<ul>
<li>User’s view consists only of data the user is allowed to access</li>
<li>Hide attributes and rows that the user cannot access at least one element of</li>
<li>Set elements user cannot access to <code>UNDEFINED</code></li>
</ul></li>
</ul>
<h3 id="truman">Truman</h3>
<ul>
<li>Truman semantics: DBMS pretends the data that the user is allowed to access is all there is
<ul>
<li>All queries succeed (even if results are incorrect)</li>
</ul></li>
<li>Non-Truman semantics: DBMS rejects queries for data the user cannot access
<ul>
<li>Successful queries are precise</li>
<li>Some queries will fail</li>
</ul></li>
</ul>
<h2 id="data-mining-and-data-release">Data mining and data release</h2>
<h3 id="data-mining">Data Mining</h3>
<ul>
<li>Combining sensitive information stored in multiple databases</li>
<li>Not just a single entity controlling data</li>
<li>Data mining tries to <em>automatically</em> find interesting patterns in data
<ul>
<li>Technologies: stats, machine learning, pattern recognition</li>
<li>Need humans to judge if the pattern makes sense (causality vs coincidence)</li>
</ul></li>
<li>Can be useful for security
<ul>
<li>e.g Learning intrusion information from logs</li>
</ul></li>
</ul>
<h4 id="security-problems">Security Problems</h4>
<ul>
<li>Confidentiality: Derivation of sensitive information
<ul>
<li>Data mining can reveal sensitive information about humans or companies</li>
<li>e.g Firestone and Ford Tires
<ul>
<li>Firestone and Ford both had some evidence of tire problems, but could not share it</li>
<li>US gov combined the data and revealed problems with Ford Explorer + Firestone tires</li>
</ul></li>
<li>e.g Data Disclosure of (City, Gender, Date of Birth)
<ul>
<li>50% of US population can be uniquely identified by (place, gender, date of birth)</li>
</ul></li>
<li>e.g Netflix Price
<ul>
<li>Netflix released 100 million anonymized ratings from 480189 users to 17770 movies</li>
<li>Can map Netflix ratings with IMDB ratings for an isolation attack</li>
</ul></li>
</ul></li>
<li>Integrity: Mistakes in data
<ul>
<li>Data in database can be wrong</li>
<li>Leads to wrong conclusions by data miners
<ul>
<li>Negatively impacts individuals</li>
<li>e.g Kennedy mistakenly put on no-fly list</li>
</ul></li>
<li>Privacy: individuals should be able to correct mistakes in data about them
<ul>
<li>However, data is shared widely and there is no formal procedure</li>
</ul></li>
<li>Can have false negatives as well</li>
</ul></li>
<li>Availability: (In)compatibility of different databases
<ul>
<li>Mined databases are created by different organizations
<ul>
<li>Primary keys, attribute semantics are different</li>
<li>e.g “name” as last name, or full name</li>
<li>e.g currency</li>
</ul></li>
<li>Databases are difficult to combine</li>
<li>Harder to find correlations</li>
</ul></li>
</ul>
<h4 id="privacy-problems">Privacy Problems</h4>
<ul>
<li>Data mining can reveal sensitive information about individuals based on aggregation and inference</li>
<li>Private companies are doing the data collection and mining
<ul>
<li>Controlled by Privacy laws (e.g PIPEDA, HIPAA)</li>
</ul></li>
<li>Governments are doing data mining as well
<ul>
<li>Secret programs that have no clear procedures</li>
<li>e.g No-fly lists, phone tapping</li>
</ul></li>
</ul>
<h3 id="privacy-preserving-data-release">Privacy Preserving Data Release</h3>
<ul>
<li>We should anonymize data records before releasing them</li>
<li>Strip names, addresses, phone numbers, etc</li>
<li>Harder than it looks
<ul>
<li>e.g Taxi trip logs
<ul>
<li>Used MD5 on medallion and license</li>
<li>Medallion and license are short with a fixed format</li>
<li>Hash functions can be reversed if input space is small</li>
</ul></li>
<li>e.g AOL search data set
<ul>
<li>Assigned random number to each user</li>
<li>Can identify a person from their search history</li>
</ul></li>
<li>87% of US population can be uniquely identified by (ZIP, gender, DOB)
<ul>
<li>e.g Look at voter registration lists</li>
</ul></li>
</ul></li>
</ul>
<h4 id="k-anonymity">k-anonymity</h4>
<ul>
<li>Ensure that for each released record, there are at least <code>k-1</code> other released records from which the record cannot be distinguished</li>
<li>k &gt;= 2</li>
<li>Methods
<ul>
<li><strong>Suppression</strong>: remove data fields</li>
<li><strong>Generalization</strong>: reduce granularity of data</li>
</ul></li>
<li>Attacks
<ul>
<li>Homogeneity attack: if there is only one value for a quasi-identifier, you know the value</li>
<li>Background knowledge attack: if you can eliminate the other values of a quasi-identifier, you know the value</li>
</ul></li>
</ul>
<h4 id="l-diversity">l-diversity</h4>
<ul>
<li>For any quasi-identifier, there should be at least <code>l</code> “well-represented” values of the sensitive fields</li>
</ul>
<h4 id="t-closeness">t-closeness</h4>
<ul>
<li>Ensure that the <em>distributions</em> of the values for any quasi-identifier are within <code>t</code> of the distribution for the whole table</li>
</ul>
<h4 id="value-swapping">Value Swapping</h4>
<ul>
<li>Perturb data by swapping values of data fields</li>
<li>Links in released records cannot be considered true</li>
<li>Increase privacy for less accuracy</li>
<li>Strong correlations will become weaker, and weak correlations may disappear</li>
</ul>
<h4 id="adding-noise">Adding Noise</h4>
<ul>
<li>Add small positive or negative error to each value</li>
<li>Distribution of underlying data should be maintained</li>
<li>Protects privacy and keeps accuracy</li>
</ul>
<h4 id="randomizing-binary-data">Randomizing Binary Data</h4>
<ul>
<li>Switch the binary value with probability <code>p</code>
<ul>
<li>Can toggle both ways or only one way (if one value is problematic)</li>
</ul></li>
<li>Provides plausible deniability</li>
</ul>
<h4 id="sampling">Sampling</h4>
<ul>
<li>Release only a subset of data
<ul>
<li>Geographic coarsening: restrict geographic identifiers to regions with enough population</li>
<li>Top/bottom-coding: add a ceiling or floor to the values
<ul>
<li>e.g Replace ages over 90 with 90 exact</li>
</ul></li>
</ul></li>
</ul>
<h4 id="synthetic-data">Synthetic Data</h4>
<ul>
<li>Build a distribution model based on gathered data and use the model to generate synthetic data with similar characteristics</li>
</ul>
<h1 id="non-technical-aspects">Non-technical Aspects</h1>
<h2 id="ethical-issues">Ethical issues</h2>
<ul>
<li>Just because something is legal doesn’t mean you should do it</li>
</ul>
<h3 id="codes-of-professional-ethics">Codes of professional ethics</h3>
<ul>
<li>Professional societies (e.g ACM, IEEE, CIPS) have codes of professional ethics</li>
<li>e.g CIPS
<ul>
<li>Protect Public Interest and Maintain Integrity</li>
<li>Demonstrate Competence and Quality of Service</li>
<li>Maintain Confidential Information and Privacy</li>
<li>Avoid Conflicts of Interest</li>
<li>Uphold Responsibility to the IT Profession</li>
</ul></li>
</ul>
<h2 id="administering-security">Administering security</h2>
<h3 id="security-planning">Security Planning</h3>
<ul>
<li><strong>Security plan</strong>: document explaining
<ul>
<li>security goals,</li>
<li>how to meet the goals</li>
<li>how to keep meeting the goals</li>
</ul></li>
</ul>
<h4 id="parts-of-a-security-plan">Parts of a security plan:</h4>
<ol type="1">
<li>Policy
<ul>
<li>High-level statement of purpose and intent</li>
<li>Specifies
<ul>
<li>Goals: relative importance of confidentiality, integrity, availability</li>
<li>Responsibility: who is responsible</li>
<li>Commitment</li>
</ul></li>
</ul></li>
<li>Current state
<ul>
<li>Risk analysis</li>
<li>Procedure for new assets of vulnerabilities</li>
<li>Limits of security responsibility</li>
<li>Privacy Impact Assessment (PIA)</li>
</ul></li>
<li>Requirements
<ul>
<li>Needs of organization
<ul>
<li><em>Who</em> is allowed to do <em>what</em>?</li>
<li>Which audit logs to keep</li>
<li>Measurements to make</li>
</ul></li>
</ul></li>
<li>Recommended controls
<ul>
<li>Mechanisms to
<ul>
<li>control vulnerabilities identified in <em>current state</em></li>
<li>satisfy needs in <em>requirements</em></li>
<li>taking into account priorities of <em>policy</em></li>
</ul></li>
</ul></li>
<li>Accountability
<ul>
<li>Who is accountable if security controls aren’t implemented properly</li>
</ul></li>
<li>Timetable
<ul>
<li>Schedule to carry out security plan</li>
<li>Includes milestones</li>
</ul></li>
<li>Continuing attention
<ul>
<li>Organization and world will change</li>
<li>Process for periodic review and updates</li>
</ul></li>
</ol>
<h4 id="security-planning-team">Security planning team:</h4>
<ul>
<li>Upper management</li>
<li>IT</li>
<li>Sysadmins</li>
<li>Physical security</li>
<li>Representative users</li>
</ul>
<h4 id="business-continuity-plans">Business continuity plans</h4>
<ul>
<li>Type of security plan focused on availability</li>
<li>What to do for
<ul>
<li>Catastrophic failures: large part of computing capability that is suddenly unavailable
<ul>
<li>e.g fire, utility failure, pandemic</li>
<li>Create a plan for
<ul>
<li>Who’s in charge</li>
<li>What to do</li>
<li>Who to do it</li>
</ul></li>
<li>Acquire resources to carry out the plan</li>
</ul></li>
<li>Long duration failures: outage expects to last long enough to affect business</li>
</ul></li>
</ul>
<h4 id="incident-response-plans">Incident response plans</h4>
<ul>
<li>Plans to respond to a security breach</li>
<li>Consider:
<ul>
<li>Legal ramifications: when to involve law enforcement</li>
<li>Preserving evidence: recover and still maintain forensic evidence</li>
<li>Records: keep track of what you notice</li>
<li>Public relations</li>
</ul></li>
<li>After recovery, consider:
<ul>
<li>Security control actions</li>
<li>Whether incident response plan was effective</li>
</ul></li>
</ul>
<h3 id="risk">Risk</h3>
<ul>
<li>Risk: potential problem a system or users may experience
<ul>
<li>Has probability and impact</li>
<li>Risk exposure = probability x impact</li>
</ul></li>
<li>Risk analysis
<ul>
<li>Determine if benefits outweigh the risks</li>
</ul></li>
<li>Steps
<ol type="1">
<li>Identify assets we want to protect
<ul>
<li>Hardware, software, data</li>
<li>People, documentation, supplies</li>
</ul></li>
<li>Determine vulnerabilities
<ul>
<li>Confidentiality, integrity, availability, privacy attacks on the above assets</li>
</ul></li>
<li>Estimate likelihood of exploitation
<ul>
<li>Get experts</li>
<li>Frequency analysis based on past occurrences of problem</li>
</ul></li>
<li>Compute risk exposure
<ul>
<li>Identify impact of risk</li>
</ul></li>
<li>Survey applicable controls
<ul>
<li>Find ways of controlling the vulnerability</li>
<li>Classify control by how well it protects against each vulnerability</li>
</ul></li>
<li>Project savings due to control
<ul>
<li>Expected cost of not controlling the risk = risk exposure</li>
<li>Cost of control is direct cost + expose of controlled risk</li>
<li>Savings = risk exposure - cost of control</li>
</ul></li>
</ol></li>
</ul>
<h3 id="physical-security">Physical Security</h3>
<ul>
<li>Need to protect physical machines</li>
<li>Two classes
<ul>
<li>Nature
<ul>
<li>e.g Fire, Flood, Blackouts</li>
<li>Have backup generators, other locations</li>
</ul></li>
<li>Human
<ul>
<li>Need to protect against loss + release of sensitive data</li>
<li>Vandals
<ul>
<li>e.g Concordia Computer center incident</li>
<li>Make backups</li>
</ul></li>
<li>Thieves
<ul>
<li>After hardware</li>
</ul></li>
<li>Targeted attackers
<ul>
<li>After data</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<h4 id="protecting-offline-data">Protecting Offline Data</h4>
<ul>
<li>Data storage devices just sitting on a shelf</li>
<li>Difficult for network-based attackers, but easy for physical attackers</li>
<li>Also need to safely dispose of data</li>
</ul>
<h3 id="testing-security-procedures">Testing Security Procedures</h3>
<ul>
<li>Tiger teams
<ul>
<li>Teams of security professionals hired to break into your system</li>
<li>They inform you about the vulnerabilities afterwards</li>
</ul></li>
</ul>
<h2 id="legal-issues">Legal issues</h2>
<h3 id="legal-protections">Legal Protections</h3>
<ul>
<li>Hardware theft can be changed</li>
<li>Copying data falls under IP</li>
</ul>
<h3 id="intellectual-property">Intellectual Property</h3>
<ul>
<li>IP is different from physical property
<ul>
<li>Non-depletable</li>
<li>Replicable</li>
<li>Minimal marginal cost</li>
</ul></li>
<li>IP types differ in kind of intangible, rights, durations, registration requirements</li>
<li>Types
<ul>
<li>Trade secrets
<ul>
<li>Protects secret information
<ul>
<li>e.g Coca-Cola formula</li>
<li>e.g Fancy algorithm</li>
</ul></li>
<li>Don’t need to tell anyone</li>
<li>If you tell someone, and they pass it on you have legal protection</li>
<li>If the secret is <em>reverse engineered</em>, you lose trade secret protection</li>
</ul></li>
<li>Trademarks
<ul>
<li>Protects names, brands, logos
<ul>
<li>e.g RC4</li>
<li>e.g Domain names</li>
</ul></li>
<li>Need to make a legal filing showing you are using the name in commerce</li>
<li>Can sue others using the same name in a confusing manner</li>
</ul></li>
<li>Patents
<ul>
<li>Protects inventions that are novel, useful, non-obvious
<ul>
<li>e.g Cryptography algorithms</li>
</ul></li>
<li>Need to explain how it works</li>
<li>Get 20 year monopoly</li>
</ul></li>
<li>Copyrights
<ul>
<li>Protects expressions of ideas in a tangible medium</li>
<li>No filing requirement</li>
<li>Limited time protection (more than lifespan)</li>
<li>Copyright holder has monopoly over uses of work including copies
<ul>
<li>Others can copy work in certain circumstances</li>
<li>USA: fair use
<ul>
<li>For purposes such as criticism, comment, news reporting, teaching, scholarship, or research</li>
</ul></li>
<li>Canada: fair dealing
<ul>
<li>Only: private study, research, criticism, review, news reporting, education, parody, and satire</li>
<li>Private copying is allowed but audio is murky</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p>^^^END OF EXAM MATERIAL</p>
<h4 id="paracopyright">Paracopyright</h4>
<ul>
<li>e.g DCMA</li>
<li>Illegal to circumvent technological copy protection</li>
<li>Even when you’re breaking copy protection to make a fair use copy</li>
</ul>
<h4 id="computer-crime">Computer Crime</h4>
<ul>
<li>Previously it was difficult to legally charge computer crime</li>
<li>Now: Unauthorized access of computers, networks, or services is legally different from physical trespass</li>
<li>Rules of Evidence
<ul>
<li>Hard to produce computer crime evidence that is admissible in court</li>
<li>e.g Are log files admissible?</li>
<li>How to preserve electronic evidence?</li>
</ul></li>
<li>Cybercrime treaties
<ul>
<li>Cyberbullying Law</li>
<li>Council of Europe says we should make it easier for law enforcement to access telecommunications traffic</li>
<li>Any ‘public officer’ can demand computer data is a person’s control not be deleted</li>
</ul></li>
<li>Back doors
<ul>
<li>Back doors are weaknesses that lower security</li>
<li>If there is a back door, the bad guys can use it too</li>
<li>e.g Greek wiretapping scandal</li>
<li><strong>Harmonization</strong> results in back doors being left in everywhere because we don’t want to build multiple versions</li>
</ul></li>
</ul>
<h4 id="redress-for-software-failures">Redress for software failures</h4>
<ul>
<li>If your software is broken, you can’t get a refund or exchange for a new one</li>
<li>Who do you tell about flaws?
<ul>
<li>Vendor
<ul>
<li>They can sue you if you publicly disclose</li>
</ul></li>
<li>Full disclosure: Post to a mailing list of security professionals
<ul>
<li>Reasoning: if you found it, the bad guys found it too</li>
<li>Need to fix ASAP without waiting for vendor</li>
<li>Put pressure on vendors</li>
</ul></li>
<li>Responsible disclosure: Tell vendor first, and give them 30 days before telling the world
<ul>
<li>Should contact a <strong>coordinating center</strong> (e.g CERT)</li>
</ul></li>
</ul></li>
</ul>
</body>
</html>
